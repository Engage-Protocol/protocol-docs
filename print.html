<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Engage Protocol</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="book.css">

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Engage Protocol</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/Engage-Protocol/engage-protocol" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="engage-protocol"><a class="header" href="#engage-protocol">Engage Protocol</a></h1>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>Engage Protocol implements a way for creators to host onchain engagement sessions, in a form of a series of prompts, where the participants react to them. After the session ended, the results are evaluated and potential rewards are distributed. The protocol implements a modular architecture with 4 key parts:</p>
<ul>
<li>SessionManager: the core protocol</li>
<li>SessionStrategies: manages the evaluation of the sessions</li>
<li>RewardStrategies: manages how many points are given for answering a prompt</li>
<li>PromptStrategies: a prompt strategy implements a certain prompt type which can be used in a session</li>
</ul>
<h2 id="architecture"><a class="header" href="#architecture">Architecture</a></h2>
<h3 id="session-sequence-diagram"><a class="header" href="#session-sequence-diagram">Session Sequence Diagram</a></h3>
<p><img src="diagrams/engage-sequence-diagram.svg" alt="SVG Image" /></p>
<h2 id="development"><a class="header" href="#development">Development</a></h2>
<p>Development and deployment is done using (foundry)[https://getfoundry.sh/introduction/overview].</p>
<h3 id="build"><a class="header" href="#build">Build</a></h3>
<pre><code class="language-shell">$ forge build
</code></pre>
<h3 id="test"><a class="header" href="#test">Test</a></h3>
<pre><code class="language-shell">$ forge test
</code></pre>
<h3 id="format"><a class="header" href="#format">Format</a></h3>
<pre><code class="language-shell">$ forge fmt
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents"><a class="header" href="#contents">Contents</a></h1>
<ul>
<li><a href="src/offchain//src/offchain/uma">uma</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-1"><a class="header" href="#contents-1">Contents</a></h1>
<ul>
<li><a href="src/offchain/uma/SessionResultAsserter.sol/abstract.SessionResultAsserter.html">SessionResultAsserter</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sessionresultasserter"><a class="header" href="#sessionresultasserter">SessionResultAsserter</a></h1>
<p><a href="https://github.com/Engage-Protocol/engage-protocol/blob/62e4edb5917eb23b13556127a45784792d64552a/src/offchain/uma/SessionResultAsserter.sol">Git Source</a></p>
<h2 id="state-variables"><a class="header" href="#state-variables">State Variables</a></h2>
<h3 id="usdc"><a class="header" href="#usdc">usdc</a></h3>
<pre><code class="language-solidity">IERC20 public immutable usdc;
</code></pre>
<h3 id="optimisticoracle"><a class="header" href="#optimisticoracle">optimisticOracle</a></h3>
<pre><code class="language-solidity">OptimisticOracleV3Interface public immutable optimisticOracle;
</code></pre>
<h3 id="assertionliveness"><a class="header" href="#assertionliveness">assertionLiveness</a></h3>
<pre><code class="language-solidity">uint64 public constant assertionLiveness = 7200;
</code></pre>
<h3 id="defaultidentifier"><a class="header" href="#defaultidentifier">defaultIdentifier</a></h3>
<pre><code class="language-solidity">bytes32 public immutable defaultIdentifier;
</code></pre>
<h3 id="assertions"><a class="header" href="#assertions">assertions</a></h3>
<pre><code class="language-solidity">mapping(bytes32 =&gt; Assertion) public assertions;
</code></pre>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<h3 id="constructor"><a class="header" href="#constructor">constructor</a></h3>
<pre><code class="language-solidity">constructor(address _usdc, address _optimisticOracle);
</code></pre>
<h3 id="getdata"><a class="header" href="#getdata">getData</a></h3>
<pre><code class="language-solidity">function getData(bytes32 assertionId) public view returns (bool, string memory, string memory);
</code></pre>
<h3 id="assertdatafor"><a class="header" href="#assertdatafor">assertDataFor</a></h3>
<pre><code class="language-solidity">function assertDataFor(
    uint256 sessionId,
    string calldata resultCid,
    string memory resolutionGitRepoAtCommitHash,
    address[] calldata winners,
    uint256[] calldata totalXPs,
    uint256[] calldata totalTimes,
    address asserter
) internal returns (bytes32 assertionId);
</code></pre>
<h3 id="assertionresolvedcallback"><a class="header" href="#assertionresolvedcallback">assertionResolvedCallback</a></h3>
<pre><code class="language-solidity">function assertionResolvedCallback(bytes32 assertionId, bool assertedTruthfully) public;
</code></pre>
<h3 id="assertiondisputedcallback"><a class="header" href="#assertiondisputedcallback">assertionDisputedCallback</a></h3>
<pre><code class="language-solidity">function assertionDisputedCallback(bytes32 assertionId) public;
</code></pre>
<h3 id="concat"><a class="header" href="#concat">concat</a></h3>
<pre><code class="language-solidity">function concat(address[] calldata addresses) internal pure returns (string memory);
</code></pre>
<h3 id="concat-1"><a class="header" href="#concat-1">concat</a></h3>
<pre><code class="language-solidity">function concat(uint256[] calldata data) internal pure returns (string memory);
</code></pre>
<h2 id="events"><a class="header" href="#events">Events</a></h2>
<h3 id="dataasserted"><a class="header" href="#dataasserted">DataAsserted</a></h3>
<pre><code class="language-solidity">event DataAsserted(
    uint256 indexed sessionId,
    string resultCid,
    string calculationCid,
    address indexed asserter,
    bytes32 indexed assertionId
);
</code></pre>
<h3 id="dataassertionresolved"><a class="header" href="#dataassertionresolved">DataAssertionResolved</a></h3>
<pre><code class="language-solidity">event DataAssertionResolved(
    uint256 indexed sessionId,
    string resultCid,
    string calculationCid,
    address indexed asserter,
    bytes32 indexed assertionId
);
</code></pre>
<h2 id="errors"><a class="header" href="#errors">Errors</a></h2>
<h3 id="invalidaddress"><a class="header" href="#invalidaddress">InvalidAddress</a></h3>
<pre><code class="language-solidity">error InvalidAddress();
</code></pre>
<h2 id="structs"><a class="header" href="#structs">Structs</a></h2>
<h3 id="assertion"><a class="header" href="#assertion">Assertion</a></h3>
<pre><code class="language-solidity">struct Assertion {
    uint256 sessionId;
    string resultCid;
    string calculationCid;
    address asserter;
    bool resolved;
    address[] winners;
    uint256[] totalXPs;
    uint256[] totalTimes;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-2"><a class="header" href="#contents-2">Contents</a></h1>
<ul>
<li><a href="src/prompt/IPromptStrategy.sol/struct.BaseReaction.html">BaseReaction</a></li>
<li><a href="src/prompt/IPromptStrategy.sol/struct.Result.html">Result</a></li>
<li><a href="src/prompt/IPromptStrategy.sol/interface.IPromptStrategy.html">IPromptStrategy</a></li>
<li><a href="src/prompt/MajorityChoicePrompt.sol/contract.MajorityChoicePrompt.html">MajorityChoicePrompt</a></li>
<li><a href="src/prompt/SPBinaryPrompt.sol/contract.SPBinaryPrompt.html">SPBinaryPrompt</a></li>
<li><a href="src/prompt/TriviaChoicePrompt.sol/contract.TriviaChoicePrompt.html">TriviaChoicePrompt</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="basereaction"><a class="header" href="#basereaction">BaseReaction</a></h1>
<p><a href="https://github.com/Engage-Protocol/engage-protocol/blob/62e4edb5917eb23b13556127a45784792d64552a/src/prompt/IPromptStrategy.sol">Git Source</a></p>
<pre><code class="language-solidity">struct BaseReaction {
    bytes32 commit;
    uint256 timestamp;
    bool doubledDown;
    bool revealed;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>commit</code></td><td><code>bytes32</code></td><td>Commitment hash of the player's answer</td></tr>
<tr><td><code>timestamp</code></td><td><code>uint256</code></td><td>When the reaction was committed</td></tr>
<tr><td><code>doubledDown</code></td><td><code>bool</code></td><td>Whether the player doubled down on their answer</td></tr>
<tr><td><code>revealed</code></td><td><code>bool</code></td><td>Whether the reaction has been revealed</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="result"><a class="header" href="#result">Result</a></h1>
<p><a href="https://github.com/Engage-Protocol/engage-protocol/blob/62e4edb5917eb23b13556127a45784792d64552a/src/prompt/IPromptStrategy.sol">Git Source</a></p>
<p>Structure containing the result of a player's participation in a question</p>
<pre><code class="language-solidity">struct Result {
    uint256 xp;
    uint256 time;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>xp</code></td><td><code>uint256</code></td><td>Experience points earned by the player</td></tr>
<tr><td><code>time</code></td><td><code>uint256</code></td><td>Time taken by the player to respond (in seconds)</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="ipromptstrategy"><a class="header" href="#ipromptstrategy">IPromptStrategy</a></h1>
<p><a href="https://github.com/Engage-Protocol/engage-protocol/blob/62e4edb5917eb23b13556127a45784792d64552a/src/prompt/IPromptStrategy.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
IERC165</p>
<p>Interface for prompt strategy contracts that manage question presentation and answer collection</p>
<p><em>This interface defines the core functionality for handling different types of questions
and managing the commit-reveal scheme for player answers. It extends IERC165 for
interface detection support.</em></p>
<h2 id="functions-1"><a class="header" href="#functions-1">Functions</a></h2>
<h3 id="revealquestion"><a class="header" href="#revealquestion">revealQuestion</a></h3>
<p>Reveals a question to players</p>
<p><em>This function is called by the session manager to make a question available to players</em></p>
<pre><code class="language-solidity">function revealQuestion(bytes memory question, uint256 questionId) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>question</code></td><td><code>bytes</code></td><td>The encoded question data</td></tr>
<tr><td><code>questionId</code></td><td><code>uint256</code></td><td>The unique identifier for the question</td></tr>
</tbody></table>
</div>
<h3 id="commitreaction"><a class="header" href="#commitreaction">commitReaction</a></h3>
<p>Allows a player to commit an answer to a question</p>
<p><em>Uses a commit-reveal scheme to prevent front-running. The actual answer is hidden
until the reveal phase begins.</em></p>
<pre><code class="language-solidity">function commitReaction(uint256 _gameId, uint256 _questionId, bytes32 _commit, address _user) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the game</td></tr>
<tr><td><code>_questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
<tr><td><code>_commit</code></td><td><code>bytes32</code></td><td>The commitment hash of the player's answer</td></tr>
<tr><td><code>_user</code></td><td><code>address</code></td><td>The address of the player</td></tr>
</tbody></table>
</div>
<h3 id="revealreaction"><a class="header" href="#revealreaction">revealReaction</a></h3>
<p>Allows a player to reveal their previously committed answer</p>
<p><em>The revealed answer must match the commitment hash provided during commit phase</em></p>
<pre><code class="language-solidity">function revealReaction(uint256 _gameId, uint256 _questionId, bytes calldata _selection, uint256 salt, address _user)
    external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the game</td></tr>
<tr><td><code>_questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
<tr><td><code>_selection</code></td><td><code>bytes</code></td><td>The encoded answer selection</td></tr>
<tr><td><code>salt</code></td><td><code>uint256</code></td><td>The salt used in the commitment</td></tr>
<tr><td><code>_user</code></td><td><code>address</code></td><td>The address of the player</td></tr>
</tbody></table>
</div>
<h3 id="getreactiontime"><a class="header" href="#getreactiontime">getReactionTime</a></h3>
<p>Gets the reaction time for a player on a specific question</p>
<pre><code class="language-solidity">function getReactionTime(uint256 questionId, address player) external view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
<tr><td><code>player</code></td><td><code>address</code></td><td>The address of the player</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The time in seconds between question reveal and player's reaction</td></tr>
</tbody></table>
</div>
<h3 id="isrevealed"><a class="header" href="#isrevealed">isRevealed</a></h3>
<p>Checks if a question has been revealed</p>
<pre><code class="language-solidity">function isRevealed(uint256 questionId) external view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>True if the question has been revealed, false otherwise</td></tr>
</tbody></table>
</div>
<h3 id="recordresult"><a class="header" href="#recordresult">recordResult</a></h3>
<p>Records the result for a player</p>
<pre><code class="language-solidity">function recordResult(uint256 questionId, address player, uint256 xp, uint256 time) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
<tr><td><code>player</code></td><td><code>address</code></td><td>The address of the player</td></tr>
<tr><td><code>xp</code></td><td><code>uint256</code></td><td>The XP value for the player</td></tr>
<tr><td><code>time</code></td><td><code>uint256</code></td><td>The time value for the player</td></tr>
</tbody></table>
</div>
<h3 id="getresult"><a class="header" href="#getresult">getResult</a></h3>
<p>Gets the result for a specific player on a specific question</p>
<pre><code class="language-solidity">function getResult(uint256 gameId, uint256 questionId, address user) external view returns (Result memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>The ID of the game</td></tr>
<tr><td><code>questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
<tr><td><code>user</code></td><td><code>address</code></td><td>The address of the player</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>Result</code></td><td>The result containing XP earned and response time</td></tr>
</tbody></table>
</div>
<h2 id="events-1"><a class="header" href="#events-1">Events</a></h2>
<h3 id="answercommitted"><a class="header" href="#answercommitted">AnswerCommitted</a></h3>
<pre><code class="language-solidity">event AnswerCommitted(uint256 indexed gameId, uint256 indexed questionId, address indexed player, bytes32 commit);
</code></pre>
<h2 id="errors-1"><a class="header" href="#errors-1">Errors</a></h2>
<h3 id="onlysessionmanager"><a class="header" href="#onlysessionmanager">OnlySessionManager</a></h3>
<pre><code class="language-solidity">error OnlySessionManager(address sessionManager, address caller);
</code></pre>
<h3 id="onlysessionstrategy"><a class="header" href="#onlysessionstrategy">OnlySessionStrategy</a></h3>
<pre><code class="language-solidity">error OnlySessionStrategy(address sessionStrategy, address caller);
</code></pre>
<h3 id="invalidgamestate"><a class="header" href="#invalidgamestate">InvalidGameState</a></h3>
<pre><code class="language-solidity">error InvalidGameState(SessionState expected, SessionState actual);
</code></pre>
<h3 id="playernotcontestant"><a class="header" href="#playernotcontestant">PlayerNotContestant</a></h3>
<pre><code class="language-solidity">error PlayerNotContestant(address player);
</code></pre>
<h3 id="answeralreadycommitted"><a class="header" href="#answeralreadycommitted">AnswerAlreadyCommitted</a></h3>
<pre><code class="language-solidity">error AnswerAlreadyCommitted(address player, uint256 gameId, uint256 questionId);
</code></pre>
<h3 id="answernotcommitted"><a class="header" href="#answernotcommitted">AnswerNotCommitted</a></h3>
<pre><code class="language-solidity">error AnswerNotCommitted(address player, uint256 gameId, uint256 questionId);
</code></pre>
<h3 id="answeralreadyrevealed"><a class="header" href="#answeralreadyrevealed">AnswerAlreadyRevealed</a></h3>
<pre><code class="language-solidity">error AnswerAlreadyRevealed(address player, uint256 gameId, uint256 questionId);
</code></pre>
<h3 id="reactiondeadlinepassed"><a class="header" href="#reactiondeadlinepassed">ReactionDeadlinePassed</a></h3>
<pre><code class="language-solidity">error ReactionDeadlinePassed(address player, uint256 questionId);
</code></pre>
<h3 id="questionnotrevealed"><a class="header" href="#questionnotrevealed">QuestionNotRevealed</a></h3>
<pre><code class="language-solidity">error QuestionNotRevealed(uint256 questionId);
</code></pre>
<h3 id="invalidquestionid"><a class="header" href="#invalidquestionid">InvalidQuestionId</a></h3>
<pre><code class="language-solidity">error InvalidQuestionId(uint256 questionId);
</code></pre>
<h3 id="invalidsessionmanager"><a class="header" href="#invalidsessionmanager">InvalidSessionManager</a></h3>
<pre><code class="language-solidity">error InvalidSessionManager(address sessionManager);
</code></pre>
<h3 id="invalidpromptcall"><a class="header" href="#invalidpromptcall">InvalidPromptCall</a></h3>
<pre><code class="language-solidity">error InvalidPromptCall(uint256 questionId, address promptStrategy);
</code></pre>
<h3 id="xpmismatch"><a class="header" href="#xpmismatch">XpMismatch</a></h3>
<pre><code class="language-solidity">error XpMismatch(uint256 xp, uint256 assertionXp);
</code></pre>
<h3 id="timemismatch"><a class="header" href="#timemismatch">TimeMismatch</a></h3>
<pre><code class="language-solidity">error TimeMismatch(uint256 time, uint256 assertionTime);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="majoritychoiceprompt"><a class="header" href="#majoritychoiceprompt">MajorityChoicePrompt</a></h1>
<p><a href="https://github.com/Engage-Protocol/engage-protocol/blob/62e4edb5917eb23b13556127a45784792d64552a/src/prompt/MajorityChoicePrompt.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
Ownable, <a href="src/prompt/MajorityChoicePrompt.sol//src/prompt/IPromptStrategy.sol/interface.IPromptStrategy.html">IPromptStrategy</a>, ERC165</p>
<p>Contract for managing majority choice questions where the most popular answer wins</p>
<p><em>This contract implements the IPromptStrategy interface for handling multiple choice
questions where players vote on options and the majority choice determines the winning answer.
It uses a commit-reveal scheme to prevent front-running and ensures fair voting.</em></p>
<h2 id="state-variables-1"><a class="header" href="#state-variables-1">State Variables</a></h2>
<h3 id="revealedquestions"><a class="header" href="#revealedquestions">revealedQuestions</a></h3>
<p>Mapping from question ID to the revealed question data</p>
<pre><code class="language-solidity">mapping(uint256 questionId =&gt; Prompt) public revealedQuestions;
</code></pre>
<h3 id="revealedat"><a class="header" href="#revealedat">revealedAt</a></h3>
<p>Mapping from question ID to the timestamp when it was revealed</p>
<pre><code class="language-solidity">mapping(uint256 questionId =&gt; uint256 timestamp) public revealedAt;
</code></pre>
<h3 id="reactions"><a class="header" href="#reactions">reactions</a></h3>
<p>Mapping from question ID and player address to their reaction</p>
<pre><code class="language-solidity">mapping(uint256 questionId =&gt; mapping(address player =&gt; Reaction reaction)) public reactions;
</code></pre>
<h3 id="choicecounters"><a class="header" href="#choicecounters">choiceCounters</a></h3>
<p>Mapping from question ID to arrays of players for each choice</p>
<pre><code class="language-solidity">mapping(uint256 questionId =&gt; address[][] choices) public choiceCounters;
</code></pre>
<h3 id="results"><a class="header" href="#results">results</a></h3>
<p>Mapping from question ID and user address to their result</p>
<pre><code class="language-solidity">mapping(uint256 questionId =&gt; mapping(address user =&gt; Result)) public results;
</code></pre>
<h3 id="registry"><a class="header" href="#registry">registry</a></h3>
<p>Registry contract address of the protocol</p>
<pre><code class="language-solidity">Registry public immutable registry;
</code></pre>
<h2 id="functions-2"><a class="header" href="#functions-2">Functions</a></h2>
<h3 id="constructor-1"><a class="header" href="#constructor-1">constructor</a></h3>
<pre><code class="language-solidity">constructor(address _owner, address _registry) Ownable(_owner);
</code></pre>
<h3 id="revealquestion-1"><a class="header" href="#revealquestion-1">revealQuestion</a></h3>
<p>Reveals a question to players</p>
<p><em>This function is called by the session manager to make a question available to players</em></p>
<pre><code class="language-solidity">function revealQuestion(bytes memory question, uint256 questionId) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>question</code></td><td><code>bytes</code></td><td>The encoded question data</td></tr>
<tr><td><code>questionId</code></td><td><code>uint256</code></td><td>The unique identifier for the question</td></tr>
</tbody></table>
</div>
<h3 id="commitreaction-1"><a class="header" href="#commitreaction-1">commitReaction</a></h3>
<p>Allows a player to commit an answer to a question</p>
<p><em>Uses a commit-reveal scheme to prevent front-running. The actual answer is hidden
until the reveal phase begins.</em></p>
<pre><code class="language-solidity">function commitReaction(uint256 _gameId, uint256 _questionId, bytes32 _commit, address _user) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the game</td></tr>
<tr><td><code>_questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
<tr><td><code>_commit</code></td><td><code>bytes32</code></td><td>The commitment hash of the player's answer</td></tr>
<tr><td><code>_user</code></td><td><code>address</code></td><td>The address of the player</td></tr>
</tbody></table>
</div>
<h3 id="revealreaction-1"><a class="header" href="#revealreaction-1">revealReaction</a></h3>
<p>Allows a player to reveal their previously committed answer</p>
<p><em>The revealed answer must match the commitment hash provided during commit phase</em></p>
<pre><code class="language-solidity">function revealReaction(uint256 _gameId, uint256 _questionId, bytes calldata _selection, uint256 salt, address _user)
    external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the game</td></tr>
<tr><td><code>_questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
<tr><td><code>_selection</code></td><td><code>bytes</code></td><td>The encoded answer selection</td></tr>
<tr><td><code>salt</code></td><td><code>uint256</code></td><td>The salt used in the commitment</td></tr>
<tr><td><code>_user</code></td><td><code>address</code></td><td>The address of the player</td></tr>
</tbody></table>
</div>
<h3 id="recordresult-1"><a class="header" href="#recordresult-1">recordResult</a></h3>
<p>Records the result for a player</p>
<pre><code class="language-solidity">function recordResult(uint256 questionId, address player, uint256 xp, uint256 time) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
<tr><td><code>player</code></td><td><code>address</code></td><td>The address of the player</td></tr>
<tr><td><code>xp</code></td><td><code>uint256</code></td><td>The XP value for the player</td></tr>
<tr><td><code>time</code></td><td><code>uint256</code></td><td>The time value for the player</td></tr>
</tbody></table>
</div>
<h3 id="getreactiontime-1"><a class="header" href="#getreactiontime-1">getReactionTime</a></h3>
<p>Gets the reaction time for a player on a specific question</p>
<pre><code class="language-solidity">function getReactionTime(uint256 questionId, address player) public view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
<tr><td><code>player</code></td><td><code>address</code></td><td>The address of the player</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The time in seconds between question reveal and player's reaction</td></tr>
</tbody></table>
</div>
<h3 id="_getreactiontime"><a class="header" href="#_getreactiontime">_getReactionTime</a></h3>
<pre><code class="language-solidity">function _getReactionTime(uint256 questionId, address player) internal view returns (uint256);
</code></pre>
<h3 id="isrevealed-1"><a class="header" href="#isrevealed-1">isRevealed</a></h3>
<p>Checks if a question has been revealed</p>
<pre><code class="language-solidity">function isRevealed(uint256 questionId) external view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>True if the question has been revealed, false otherwise</td></tr>
</tbody></table>
</div>
<h3 id="getresult-1"><a class="header" href="#getresult-1">getResult</a></h3>
<p>Gets the result for a specific player on a specific question</p>
<pre><code class="language-solidity">function getResult(uint256, uint256 questionId, address user) external view returns (Result memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td></td></tr>
<tr><td><code>questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
<tr><td><code>user</code></td><td><code>address</code></td><td>The address of the player</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>Result</code></td><td>The result containing XP earned and response time</td></tr>
</tbody></table>
</div>
<h3 id="getquestion"><a class="header" href="#getquestion">getQuestion</a></h3>
<p>Retrieves details of a single question</p>
<pre><code class="language-solidity">function getQuestion(uint256 _questionId)
    external
    view
    returns (
        uint256 gameId,
        string memory questionText,
        uint256 reactionDeadline,
        string memory finalizedAnswer,
        string[] memory choices
    );
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>The ID of the game this question belongs to</td></tr>
<tr><td><code>questionText</code></td><td><code>string</code></td><td>The text of the question</td></tr>
<tr><td><code>reactionDeadline</code></td><td><code>uint256</code></td><td>The deadline for players to commit their answers</td></tr>
<tr><td><code>finalizedAnswer</code></td><td><code>string</code></td><td>The final answer after all votes are revealed</td></tr>
<tr><td><code>choices</code></td><td><code>string[]</code></td><td>Array of possible answer choices</td></tr>
</tbody></table>
</div>
<h3 id="noop"><a class="header" href="#noop">noop</a></h3>
<pre><code class="language-solidity">function noop(Prompt calldata p) external pure;
</code></pre>
<h3 id="supportsinterface"><a class="header" href="#supportsinterface">supportsInterface</a></h3>
<pre><code class="language-solidity">function supportsInterface(bytes4 interfaceId) public view override(IERC165, ERC165) returns (bool);
</code></pre>
<h2 id="events-2"><a class="header" href="#events-2">Events</a></h2>
<h3 id="answerrevealed"><a class="header" href="#answerrevealed">AnswerRevealed</a></h3>
<pre><code class="language-solidity">event AnswerRevealed(uint256 indexed gameId, uint256 indexed questionId, address indexed player, uint16 selection);
</code></pre>
<h2 id="errors-2"><a class="header" href="#errors-2">Errors</a></h2>
<h3 id="revealmismatch"><a class="header" href="#revealmismatch">RevealMismatch</a></h3>
<pre><code class="language-solidity">error RevealMismatch(uint256 gameId, uint256 questionId, uint16 majorityChoice, uint256 salt, bytes32 commit);
</code></pre>
<h3 id="invalidorderlength"><a class="header" href="#invalidorderlength">InvalidOrderLength</a></h3>
<pre><code class="language-solidity">error InvalidOrderLength(uint256 length);
</code></pre>
<h3 id="invalidorder"><a class="header" href="#invalidorder">InvalidOrder</a></h3>
<pre><code class="language-solidity">error InvalidOrder();
</code></pre>
<h3 id="invalidposition"><a class="header" href="#invalidposition">InvalidPosition</a></h3>
<pre><code class="language-solidity">error InvalidPosition(address player, address actualPlayer);
</code></pre>
<h2 id="structs-1"><a class="header" href="#structs-1">Structs</a></h2>
<h3 id="prompt"><a class="header" href="#prompt">Prompt</a></h3>
<p>Structure containing all the data for a revealed question</p>
<p><em>This struct holds all the information needed to display and process a question</em></p>
<pre><code class="language-solidity">struct Prompt {
    address sessionManager;
    uint256 gameId;
    string questionText;
    uint256 reactionDeadline;
    string finalizedAnswer;
    string[] media;
    string[] choices;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>sessionManager</code></td><td><code>address</code></td><td>Address of the session manager where the question belongs to</td></tr>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>ID of the game this question belongs to</td></tr>
<tr><td><code>questionText</code></td><td><code>string</code></td><td>Text of the question</td></tr>
<tr><td><code>reactionDeadline</code></td><td><code>uint256</code></td><td>Deadline for players to commit their answers</td></tr>
<tr><td><code>finalizedAnswer</code></td><td><code>string</code></td><td>Final answer after all votes are revealed</td></tr>
<tr><td><code>media</code></td><td><code>string[]</code></td><td>Array of media URLs associated with the question</td></tr>
<tr><td><code>choices</code></td><td><code>string[]</code></td><td>Array of possible answer choices</td></tr>
</tbody></table>
</div>
<h3 id="reaction"><a class="header" href="#reaction">Reaction</a></h3>
<p>Structure for storing a player's reaction to a question</p>
<p><em>Extends BaseReaction with the specific answer choice selected</em></p>
<pre><code class="language-solidity">struct Reaction {
    BaseReaction baseReaction;
    uint16 answer;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>baseReaction</code></td><td><code>BaseReaction</code></td><td>Base reaction data (commit, timestamp, etc.)</td></tr>
<tr><td><code>answer</code></td><td><code>uint16</code></td><td>The answer choice selected by the player (0-indexed)</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="spbinaryprompt"><a class="header" href="#spbinaryprompt">SPBinaryPrompt</a></h1>
<p><a href="https://github.com/Engage-Protocol/engage-protocol/blob/62e4edb5917eb23b13556127a45784792d64552a/src/prompt/SPBinaryPrompt.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
Ownable, <a href="src/prompt/SPBinaryPrompt.sol//src/prompt/IPromptStrategy.sol/interface.IPromptStrategy.html">IPromptStrategy</a>, ERC165</p>
<p>Contract for managing binary choice questions based on the Surprisingly Popular
method https://www.nature.com/articles/nature21054</p>
<p><em>This contract implements the IPromptStrategy interface for handling binary choice
questions where players must predict both their answer choice and the probability
of that answer being correct. The scoring system rewards players based on how
close their probability prediction is to the actual outcome.</em></p>
<h2 id="state-variables-2"><a class="header" href="#state-variables-2">State Variables</a></h2>
<h3 id="precision"><a class="header" href="#precision">PRECISION</a></h3>
<p>Precision factor for probability calculations (10000 = 100%)</p>
<pre><code class="language-solidity">uint256 public constant PRECISION = 10_000;
</code></pre>
<h3 id="revealedquestions-1"><a class="header" href="#revealedquestions-1">revealedQuestions</a></h3>
<p>Mapping from question ID to the revealed question data</p>
<pre><code class="language-solidity">mapping(uint256 questionId =&gt; Prompt) public revealedQuestions;
</code></pre>
<h3 id="revealedat-1"><a class="header" href="#revealedat-1">revealedAt</a></h3>
<p>Mapping from question ID to the timestamp when it was revealed</p>
<pre><code class="language-solidity">mapping(uint256 questionId =&gt; uint256 timestamp) public revealedAt;
</code></pre>
<h3 id="reactions-1"><a class="header" href="#reactions-1">reactions</a></h3>
<p>Mapping from question ID and player address to their reaction</p>
<pre><code class="language-solidity">mapping(uint256 questionId =&gt; mapping(address player =&gt; Reaction reaction)) public reactions;
</code></pre>
<h3 id="resultaggregates"><a class="header" href="#resultaggregates">resultAggregates</a></h3>
<p>Mapping from question ID to the aggregated results</p>
<pre><code class="language-solidity">mapping(uint256 questionId =&gt; ResultAggregate result) public resultAggregates;
</code></pre>
<h3 id="results-1"><a class="header" href="#results-1">results</a></h3>
<p>Mapping from question ID and user address to their result</p>
<pre><code class="language-solidity">mapping(uint256 questionId =&gt; mapping(address user =&gt; Result)) public results;
</code></pre>
<h3 id="registry-1"><a class="header" href="#registry-1">registry</a></h3>
<pre><code class="language-solidity">Registry public immutable registry;
</code></pre>
<h2 id="functions-3"><a class="header" href="#functions-3">Functions</a></h2>
<h3 id="constructor-2"><a class="header" href="#constructor-2">constructor</a></h3>
<pre><code class="language-solidity">constructor(address _owner, address _registry) Ownable(_owner);
</code></pre>
<h3 id="revealquestion-2"><a class="header" href="#revealquestion-2">revealQuestion</a></h3>
<p>Reveals a question to players</p>
<p><em>This function is called by the session manager to make a question available to players</em></p>
<pre><code class="language-solidity">function revealQuestion(bytes memory question, uint256 questionId) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>question</code></td><td><code>bytes</code></td><td>The encoded question data</td></tr>
<tr><td><code>questionId</code></td><td><code>uint256</code></td><td>The unique identifier for the question</td></tr>
</tbody></table>
</div>
<h3 id="commitreaction-2"><a class="header" href="#commitreaction-2">commitReaction</a></h3>
<p>Allows a player to commit an answer to a question</p>
<p><em>Uses a commit-reveal scheme to prevent front-running. The actual answer is hidden
until the reveal phase begins.</em></p>
<pre><code class="language-solidity">function commitReaction(uint256 _gameId, uint256 _questionId, bytes32 _commit, address _user) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the game</td></tr>
<tr><td><code>_questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
<tr><td><code>_commit</code></td><td><code>bytes32</code></td><td>The commitment hash of the player's answer</td></tr>
<tr><td><code>_user</code></td><td><code>address</code></td><td>The address of the player</td></tr>
</tbody></table>
</div>
<h3 id="revealreaction-2"><a class="header" href="#revealreaction-2">revealReaction</a></h3>
<p>Allows a player to reveal their previously committed answer</p>
<p><em>The revealed answer must match the commitment hash provided during commit phase</em></p>
<pre><code class="language-solidity">function revealReaction(uint256 _gameId, uint256 _questionId, bytes calldata _selection, uint256 salt, address _user)
    external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the game</td></tr>
<tr><td><code>_questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
<tr><td><code>_selection</code></td><td><code>bytes</code></td><td>The encoded answer selection</td></tr>
<tr><td><code>salt</code></td><td><code>uint256</code></td><td>The salt used in the commitment</td></tr>
<tr><td><code>_user</code></td><td><code>address</code></td><td>The address of the player</td></tr>
</tbody></table>
</div>
<h3 id="getwinninganswer"><a class="header" href="#getwinninganswer">getWinningAnswer</a></h3>
<p>Determines the winning answer based on the aggregated results</p>
<pre><code class="language-solidity">function getWinningAnswer(uint256 questionId) public view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>True if answer A is the winner, false if answer B is the winner</td></tr>
</tbody></table>
</div>
<h3 id="getscore"><a class="header" href="#getscore">getScore</a></h3>
<p>Calculates the score for a player based on their probability prediction accuracy</p>
<pre><code class="language-solidity">function getScore(uint256 questionId, address player) public view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
<tr><td><code>player</code></td><td><code>address</code></td><td>The address of the player</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The player's score (0-10000 scale)</td></tr>
</tbody></table>
</div>
<h3 id="_getaveragediffs"><a class="header" href="#_getaveragediffs">_getAverageDiffs</a></h3>
<p>Internal function to calculate the differences between answer and probability averages</p>
<pre><code class="language-solidity">function _getAverageDiffs(uint256 questionId) internal view returns (int256, int256, bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>int256</code></td><td>answerAAverageDiff The difference for answer A</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>int256</code></td><td>answerBAverageDiff The difference for answer B</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>answerAIsWinner Whether answer A is the winner</td></tr>
</tbody></table>
</div>
<h3 id="recordresult-2"><a class="header" href="#recordresult-2">recordResult</a></h3>
<p>Records the result for a player</p>
<pre><code class="language-solidity">function recordResult(uint256 questionId, address player, uint256 xp, uint256 time) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
<tr><td><code>player</code></td><td><code>address</code></td><td>The address of the player</td></tr>
<tr><td><code>xp</code></td><td><code>uint256</code></td><td>The XP value for the player</td></tr>
<tr><td><code>time</code></td><td><code>uint256</code></td><td>The time value for the player</td></tr>
</tbody></table>
</div>
<h3 id="getreactiontime-2"><a class="header" href="#getreactiontime-2">getReactionTime</a></h3>
<p>Gets the reaction time for a player on a specific question</p>
<pre><code class="language-solidity">function getReactionTime(uint256 questionId, address player) public view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
<tr><td><code>player</code></td><td><code>address</code></td><td>The address of the player</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The time in seconds between question reveal and player's reaction</td></tr>
</tbody></table>
</div>
<h3 id="_getreactiontime-1"><a class="header" href="#_getreactiontime-1">_getReactionTime</a></h3>
<pre><code class="language-solidity">function _getReactionTime(uint256 questionId, address player) internal view returns (uint256);
</code></pre>
<h3 id="isrevealed-2"><a class="header" href="#isrevealed-2">isRevealed</a></h3>
<p>Checks if a question has been revealed</p>
<pre><code class="language-solidity">function isRevealed(uint256 questionId) external view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>True if the question has been revealed, false otherwise</td></tr>
</tbody></table>
</div>
<h3 id="getresult-2"><a class="header" href="#getresult-2">getResult</a></h3>
<p>Gets the result for a specific player on a specific question</p>
<p><em>XP is calculated as: for a correct answer 1/2 of xpTiers[0] + 1/2 of xpTiers[0] * score (score is between 0 and 10000) / 10000, which means 100xp max.
incorrect answer xpTiers[1] XP is rewarded.</em></p>
<pre><code class="language-solidity">function getResult(uint256 gameId, uint256 questionId, address user) public view returns (Result memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>The ID of the game</td></tr>
<tr><td><code>questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
<tr><td><code>user</code></td><td><code>address</code></td><td>The address of the player</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>Result</code></td><td>The result containing XP earned and response time</td></tr>
</tbody></table>
</div>
<h3 id="getquestion-1"><a class="header" href="#getquestion-1">getQuestion</a></h3>
<p>Retrieves details of a single question</p>
<pre><code class="language-solidity">function getQuestion(uint256 _questionId)
    external
    view
    returns (
        uint256 gameId,
        string memory questionText,
        uint256 reactionDeadline,
        string memory finalizedAnswer,
        string[2] memory choices
    );
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>The ID of the game this question belongs to</td></tr>
<tr><td><code>questionText</code></td><td><code>string</code></td><td>The text of the question</td></tr>
<tr><td><code>reactionDeadline</code></td><td><code>uint256</code></td><td>The deadline for players to commit their answers</td></tr>
<tr><td><code>finalizedAnswer</code></td><td><code>string</code></td><td>The final answer after all votes are revealed</td></tr>
<tr><td><code>choices</code></td><td><code>string[2]</code></td><td>Array of exactly 2 possible answer choices</td></tr>
</tbody></table>
</div>
<h3 id="noop-1"><a class="header" href="#noop-1">noop</a></h3>
<pre><code class="language-solidity">function noop(Prompt calldata p) external pure;
</code></pre>
<h3 id="supportsinterface-1"><a class="header" href="#supportsinterface-1">supportsInterface</a></h3>
<pre><code class="language-solidity">function supportsInterface(bytes4 interfaceId) public view override(IERC165, ERC165) returns (bool);
</code></pre>
<h2 id="events-3"><a class="header" href="#events-3">Events</a></h2>
<h3 id="answerrevealed-1"><a class="header" href="#answerrevealed-1">AnswerRevealed</a></h3>
<pre><code class="language-solidity">event AnswerRevealed(
    uint256 indexed gameId, uint256 indexed questionId, address indexed player, bool answer, uint16 probability
);
</code></pre>
<h2 id="errors-3"><a class="header" href="#errors-3">Errors</a></h2>
<h3 id="revealmismatch-1"><a class="header" href="#revealmismatch-1">RevealMismatch</a></h3>
<pre><code class="language-solidity">error RevealMismatch(uint256 gameId, uint256 questionId, bool answer, uint16 probability, uint256 salt, bytes32 commit);
</code></pre>
<h3 id="nochoices"><a class="header" href="#nochoices">NoChoices</a></h3>
<pre><code class="language-solidity">error NoChoices(uint256 questionId);
</code></pre>
<h3 id="invalidorderlength-1"><a class="header" href="#invalidorderlength-1">InvalidOrderLength</a></h3>
<pre><code class="language-solidity">error InvalidOrderLength(uint256 length);
</code></pre>
<h3 id="invalidorder-1"><a class="header" href="#invalidorder-1">InvalidOrder</a></h3>
<pre><code class="language-solidity">error InvalidOrder();
</code></pre>
<h3 id="invalidposition-1"><a class="header" href="#invalidposition-1">InvalidPosition</a></h3>
<pre><code class="language-solidity">error InvalidPosition(address player, address actualPlayer);
</code></pre>
<h3 id="invalidtiedchoiceslength"><a class="header" href="#invalidtiedchoiceslength">InvalidTiedChoicesLength</a></h3>
<pre><code class="language-solidity">error InvalidTiedChoicesLength(uint256 fasterPicksInTiedChoicesLength, uint256 tiedChoicesLength);
</code></pre>
<h3 id="incorrecttiedchoiceplacement"><a class="header" href="#incorrecttiedchoiceplacement">IncorrectTiedChoicePlacement</a></h3>
<pre><code class="language-solidity">error IncorrectTiedChoicePlacement(address player, address lastFastestPlayerInTiedChoice);
</code></pre>
<h2 id="structs-2"><a class="header" href="#structs-2">Structs</a></h2>
<h3 id="prompt-1"><a class="header" href="#prompt-1">Prompt</a></h3>
<p>Structure containing all the data for a revealed question</p>
<p><em>This struct holds all the information needed to display and process a binary question</em></p>
<pre><code class="language-solidity">struct Prompt {
    address sessionManager;
    uint256 gameId;
    string questionText;
    uint256 reactionDeadline;
    string finalizedAnswer;
    uint16 personalAverage;
    uint16 probabilityAverage;
    string[2] choices;
    string[] media;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>sessionManager</code></td><td><code>address</code></td><td>Address of the session manager where the question belongs to</td></tr>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>ID of the game this question belongs to</td></tr>
<tr><td><code>questionText</code></td><td><code>string</code></td><td>Text of the question</td></tr>
<tr><td><code>reactionDeadline</code></td><td><code>uint256</code></td><td>Deadline for players to commit their answers</td></tr>
<tr><td><code>finalizedAnswer</code></td><td><code>string</code></td><td>Final answer after all votes are revealed</td></tr>
<tr><td><code>personalAverage</code></td><td><code>uint16</code></td><td>Personal average score for the player</td></tr>
<tr><td><code>probabilityAverage</code></td><td><code>uint16</code></td><td>Average probability prediction across all players</td></tr>
<tr><td><code>choices</code></td><td><code>string[2]</code></td><td>Array of exactly 2 possible answer choices</td></tr>
<tr><td><code>media</code></td><td><code>string[]</code></td><td>Array of media URLs associated with the question</td></tr>
</tbody></table>
</div>
<h3 id="reaction-1"><a class="header" href="#reaction-1">Reaction</a></h3>
<p>Structure for storing a player's reaction to a question</p>
<p><em>Extends BaseReaction with the specific answer choice and probability prediction</em></p>
<pre><code class="language-solidity">struct Reaction {
    BaseReaction baseReaction;
    bool answer;
    uint16 probability;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>baseReaction</code></td><td><code>BaseReaction</code></td><td>Base reaction data (commit, timestamp, etc.)</td></tr>
<tr><td><code>answer</code></td><td><code>bool</code></td><td>The binary answer choice selected by the player</td></tr>
<tr><td><code>probability</code></td><td><code>uint16</code></td><td>The player's probability prediction (0-10000 scale)</td></tr>
</tbody></table>
</div>
<h3 id="resultaggregate"><a class="header" href="#resultaggregate">ResultAggregate</a></h3>
<p>Structure for aggregating results across all players</p>
<p><em>Contains running totals and averages for answer choices and probability predictions</em></p>
<pre><code class="language-solidity">struct ResultAggregate {
    uint256 answerTotal;
    uint256 probabilityTotal;
    uint256 respondents;
    uint256 answerAverage;
    uint256 probabilityAverage;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>answerTotal</code></td><td><code>uint256</code></td><td>Total of all answer choices (weighted by PRECISION)</td></tr>
<tr><td><code>probabilityTotal</code></td><td><code>uint256</code></td><td>Total of all probability predictions</td></tr>
<tr><td><code>respondents</code></td><td><code>uint256</code></td><td>Number of players who have revealed their answers</td></tr>
<tr><td><code>answerAverage</code></td><td><code>uint256</code></td><td>Average answer choice across all players</td></tr>
<tr><td><code>probabilityAverage</code></td><td><code>uint256</code></td><td>Average probability prediction across all players</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="triviachoiceprompt"><a class="header" href="#triviachoiceprompt">TriviaChoicePrompt</a></h1>
<p><a href="https://github.com/Engage-Protocol/engage-protocol/blob/62e4edb5917eb23b13556127a45784792d64552a/src/prompt/TriviaChoicePrompt.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/prompt/TriviaChoicePrompt.sol//src/prompt/IPromptStrategy.sol/interface.IPromptStrategy.html">IPromptStrategy</a>, ERC165</p>
<p>Contract for managing trivia questions with predefined correct answers</p>
<p><em>This contract implements the IPromptStrategy interface for handling multiple choice
trivia questions where there is a single correct answer. Players are rewarded based
on whether they select the correct answer or not.</em></p>
<h2 id="state-variables-3"><a class="header" href="#state-variables-3">State Variables</a></h2>
<h3 id="revealedquestions-2"><a class="header" href="#revealedquestions-2">revealedQuestions</a></h3>
<p>Mapping from question ID to the revealed question data</p>
<pre><code class="language-solidity">mapping(uint256 questionId =&gt; Prompt) public revealedQuestions;
</code></pre>
<h3 id="revealedat-2"><a class="header" href="#revealedat-2">revealedAt</a></h3>
<p>Mapping from question ID to the timestamp when it was revealed</p>
<pre><code class="language-solidity">mapping(uint256 questionId =&gt; uint256 timestamp) public revealedAt;
</code></pre>
<h3 id="solutionrevealedat"><a class="header" href="#solutionrevealedat">solutionRevealedAt</a></h3>
<p>Mapping from question ID to the timestamp when the solution was revealed</p>
<pre><code class="language-solidity">mapping(uint256 questionId =&gt; uint256 timestamp) public solutionRevealedAt;
</code></pre>
<h3 id="reactions-2"><a class="header" href="#reactions-2">reactions</a></h3>
<p>Mapping from question ID and player address to their reaction</p>
<pre><code class="language-solidity">mapping(uint256 questionId =&gt; mapping(address player =&gt; Reaction reaction)) public reactions;
</code></pre>
<h3 id="registry-2"><a class="header" href="#registry-2">registry</a></h3>
<pre><code class="language-solidity">Registry public immutable registry;
</code></pre>
<h2 id="functions-4"><a class="header" href="#functions-4">Functions</a></h2>
<h3 id="constructor-3"><a class="header" href="#constructor-3">constructor</a></h3>
<pre><code class="language-solidity">constructor(address _registry);
</code></pre>
<h3 id="revealquestion-3"><a class="header" href="#revealquestion-3">revealQuestion</a></h3>
<p>Reveals a question to players</p>
<p><em>This function is called by the session manager to make a question available to players</em></p>
<pre><code class="language-solidity">function revealQuestion(bytes memory question, uint256 questionId) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>question</code></td><td><code>bytes</code></td><td>The encoded question data</td></tr>
<tr><td><code>questionId</code></td><td><code>uint256</code></td><td>The unique identifier for the question</td></tr>
</tbody></table>
</div>
<h3 id="revealsolutions"><a class="header" href="#revealsolutions">revealSolutions</a></h3>
<p>Reveals the correct answers for multiple questions</p>
<p><em>This function allows the session manager to reveal the correct answers for
multiple questions at once. Each solution must match its commitment hash.</em></p>
<pre><code class="language-solidity">function revealSolutions(
    uint256 gameId,
    uint256[] memory questionIds,
    bytes[] calldata solutions,
    uint256[] calldata salts
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>The ID of the game</td></tr>
<tr><td><code>questionIds</code></td><td><code>uint256[]</code></td><td>Array of question IDs to reveal solutions for</td></tr>
<tr><td><code>solutions</code></td><td><code>bytes[]</code></td><td>Array of encoded solution data</td></tr>
<tr><td><code>salts</code></td><td><code>uint256[]</code></td><td>Array of salts used in the commitments</td></tr>
</tbody></table>
</div>
<h3 id="_revealsolutions"><a class="header" href="#_revealsolutions">_revealSolutions</a></h3>
<p>Internal function to reveal the solution for a single question</p>
<p><em>This function verifies that the revealed solution matches the commitment hash
and stores the solution in the revealedQuestions mapping.</em></p>
<pre><code class="language-solidity">function _revealSolutions(uint256 _gameId, uint256 _questionId, bytes calldata _solution, uint256 salt) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the game</td></tr>
<tr><td><code>_questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
<tr><td><code>_solution</code></td><td><code>bytes</code></td><td>The encoded solution selection</td></tr>
<tr><td><code>salt</code></td><td><code>uint256</code></td><td>The salt used in the commitment</td></tr>
</tbody></table>
</div>
<h3 id="commitreaction-3"><a class="header" href="#commitreaction-3">commitReaction</a></h3>
<p>Allows a player to commit an answer to a question</p>
<p><em>Uses a commit-reveal scheme to prevent front-running. The actual answer is hidden
until the reveal phase begins.</em></p>
<pre><code class="language-solidity">function commitReaction(uint256 _gameId, uint256 _questionId, bytes32 _commit, address _user) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the game</td></tr>
<tr><td><code>_questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
<tr><td><code>_commit</code></td><td><code>bytes32</code></td><td>The commitment hash of the player's answer</td></tr>
<tr><td><code>_user</code></td><td><code>address</code></td><td>The address of the player</td></tr>
</tbody></table>
</div>
<h3 id="revealreaction-3"><a class="header" href="#revealreaction-3">revealReaction</a></h3>
<p>Allows a player to reveal their previously committed answer</p>
<p><em>The revealed answer must match the commitment hash provided during commit phase</em></p>
<pre><code class="language-solidity">function revealReaction(uint256 _gameId, uint256 _questionId, bytes calldata _selection, uint256 salt, address _user)
    external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the game</td></tr>
<tr><td><code>_questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
<tr><td><code>_selection</code></td><td><code>bytes</code></td><td>The encoded answer selection</td></tr>
<tr><td><code>salt</code></td><td><code>uint256</code></td><td>The salt used in the commitment</td></tr>
<tr><td><code>_user</code></td><td><code>address</code></td><td>The address of the player</td></tr>
</tbody></table>
</div>
<h3 id="isrevealed-3"><a class="header" href="#isrevealed-3">isRevealed</a></h3>
<p>Checks if a question has been revealed</p>
<pre><code class="language-solidity">function isRevealed(uint256 questionId) external view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>True if the question has been revealed, false otherwise</td></tr>
</tbody></table>
</div>
<h3 id="getresult-3"><a class="header" href="#getresult-3">getResult</a></h3>
<p>Gets the result for a specific player on a specific question</p>
<p><em>The result is calculated based on whether the player's answer matches the correct solution.
Players who answer correctly get XP from the first tier, while incorrect answers get XP from the second tier.</em></p>
<pre><code class="language-solidity">function getResult(uint256 gameId, uint256 questionId, address user) public view returns (Result memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>The ID of the game</td></tr>
<tr><td><code>questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
<tr><td><code>user</code></td><td><code>address</code></td><td>The address of the player</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>Result</code></td><td>The result containing XP earned and response time</td></tr>
</tbody></table>
</div>
<h3 id="recordresult-3"><a class="header" href="#recordresult-3">recordResult</a></h3>
<p>Records the result for a player</p>
<p><em>Trivia results are calculated onchain so there's no need to record the result by an oracle</em></p>
<pre><code class="language-solidity">function recordResult(uint256, address, uint256, uint256) external pure;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td></td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td></td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td></td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td></td></tr>
</tbody></table>
</div>
<h3 id="getreactiontime-3"><a class="header" href="#getreactiontime-3">getReactionTime</a></h3>
<p>Gets the reaction time for a player on a specific question</p>
<pre><code class="language-solidity">function getReactionTime(uint256 questionId, address player) public view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>questionId</code></td><td><code>uint256</code></td><td>The ID of the question</td></tr>
<tr><td><code>player</code></td><td><code>address</code></td><td>The address of the player</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The time in seconds between question reveal and player's reaction</td></tr>
</tbody></table>
</div>
<h3 id="_getreactiontime-2"><a class="header" href="#_getreactiontime-2">_getReactionTime</a></h3>
<pre><code class="language-solidity">function _getReactionTime(uint256 questionId, address player) internal view returns (uint256);
</code></pre>
<h3 id="noop-2"><a class="header" href="#noop-2">noop</a></h3>
<pre><code class="language-solidity">function noop(Prompt calldata p) external pure;
</code></pre>
<h3 id="supportsinterface-2"><a class="header" href="#supportsinterface-2">supportsInterface</a></h3>
<pre><code class="language-solidity">function supportsInterface(bytes4 interfaceId) public view virtual override(IERC165, ERC165) returns (bool);
</code></pre>
<h2 id="events-4"><a class="header" href="#events-4">Events</a></h2>
<h3 id="answerrevealed-2"><a class="header" href="#answerrevealed-2">AnswerRevealed</a></h3>
<pre><code class="language-solidity">event AnswerRevealed(uint256 indexed gameId, uint256 indexed questionId, address indexed player, uint16 selection);
</code></pre>
<h2 id="errors-4"><a class="header" href="#errors-4">Errors</a></h2>
<h3 id="revealmismatch-2"><a class="header" href="#revealmismatch-2">RevealMismatch</a></h3>
<pre><code class="language-solidity">error RevealMismatch(uint256 gameId, uint256 questionId, uint16 selection, uint256 salt, bytes32 commitment);
</code></pre>
<h3 id="solutionalreadyrevealed"><a class="header" href="#solutionalreadyrevealed">SolutionAlreadyRevealed</a></h3>
<pre><code class="language-solidity">error SolutionAlreadyRevealed(uint256 questionId);
</code></pre>
<h2 id="structs-3"><a class="header" href="#structs-3">Structs</a></h2>
<h3 id="prompt-2"><a class="header" href="#prompt-2">Prompt</a></h3>
<p>Structure containing all the data for a revealed question</p>
<p><em>This struct holds all the information needed to display and process a trivia question</em></p>
<pre><code class="language-solidity">struct Prompt {
    address sessionManager;
    uint256 gameId;
    string questionText;
    uint256 reactionDeadline;
    bytes32 solutionCommitment;
    uint16 solution;
    string[] media;
    string[] choices;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>sessionManager</code></td><td><code>address</code></td><td>Address of the session manager where the question belongs to</td></tr>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>ID of the game this question belongs to</td></tr>
<tr><td><code>questionText</code></td><td><code>string</code></td><td>Text of the question</td></tr>
<tr><td><code>reactionDeadline</code></td><td><code>uint256</code></td><td>Deadline for players to commit their answers</td></tr>
<tr><td><code>solutionCommitment</code></td><td><code>bytes32</code></td><td>Commitment hash of the correct answer</td></tr>
<tr><td><code>solution</code></td><td><code>uint16</code></td><td>The correct answer choice (0-indexed)</td></tr>
<tr><td><code>media</code></td><td><code>string[]</code></td><td></td></tr>
<tr><td><code>choices</code></td><td><code>string[]</code></td><td></td></tr>
</tbody></table>
</div>
<h3 id="reaction-2"><a class="header" href="#reaction-2">Reaction</a></h3>
<p>Structure for storing a player's reaction to a question</p>
<p><em>Extends BaseReaction with the specific answer choice selected</em></p>
<pre><code class="language-solidity">struct Reaction {
    BaseReaction baseReaction;
    uint16 answer;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>baseReaction</code></td><td><code>BaseReaction</code></td><td>Base reaction data (commit, timestamp, etc.)</td></tr>
<tr><td><code>answer</code></td><td><code>uint16</code></td><td>The answer choice selected by the player (0-indexed)</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="contents-3"><a class="header" href="#contents-3">Contents</a></h1>
<ul>
<li><a href="src/reward/FixedRanksReward.sol/contract.FixedRanksReward.html">FixedRanksReward</a></li>
<li><a href="src/reward/IRewardStrategy.sol/interface.IRewardStrategy.html">IRewardStrategy</a></li>
<li><a href="src/reward/ProportionalToXPReward.sol/contract.ProportionalToXPReward.html">ProportionalToXPReward</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="fixedranksreward"><a class="header" href="#fixedranksreward">FixedRanksReward</a></h1>
<p><a href="https://github.com/Engage-Protocol/engage-protocol/blob/62e4edb5917eb23b13556127a45784792d64552a/src/reward/FixedRanksReward.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/reward/FixedRanksReward.sol//src/reward/IRewardStrategy.sol/interface.IRewardStrategy.html">IRewardStrategy</a>, ERC165</p>
<p>Contract for distributing rewards based on predefined rank percentages</p>
<p><em>This contract implements the IRewardStrategy interface for distributing rewards
using fixed percentages for each rank. The total of all rank percentages must
equal 100% (10,000 basis points). Only the game creator can set the reward
distribution percentages.</em></p>
<h2 id="state-variables-4"><a class="header" href="#state-variables-4">State Variables</a></h2>
<h3 id="rankedrewards"><a class="header" href="#rankedrewards">rankedRewards</a></h3>
<p>Mapping from game ID to the reward percentages for each rank</p>
<p><em>Each percentage is in basis points (10000 = 100%)</em></p>
<pre><code class="language-solidity">mapping(uint256 sessionId =&gt; uint256[]) public rankedRewards;
</code></pre>
<h3 id="sessionmanager"><a class="header" href="#sessionmanager">sessionManager</a></h3>
<p>Reference to the session manager contract</p>
<pre><code class="language-solidity">SessionManager public immutable sessionManager;
</code></pre>
<h3 id="basis_points"><a class="header" href="#basis_points">BASIS_POINTS</a></h3>
<p>Basis points constant for percentage calculations (10000 = 100%)</p>
<pre><code class="language-solidity">uint256 public constant BASIS_POINTS = 10_000;
</code></pre>
<h2 id="functions-5"><a class="header" href="#functions-5">Functions</a></h2>
<h3 id="constructor-4"><a class="header" href="#constructor-4">constructor</a></h3>
<pre><code class="language-solidity">constructor(address _sessionManager);
</code></pre>
<h3 id="setrankedrewards"><a class="header" href="#setrankedrewards">setRankedRewards</a></h3>
<p>Sets the reward distribution percentages for a specific game</p>
<p><em>Only the game creator can call this function. The total of all percentages
must equal 100% (10,000 basis points). Can only be set once per game.</em></p>
<pre><code class="language-solidity">function setRankedRewards(uint256 sessionId, uint256[] calldata _rankedRewards) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>sessionId</code></td><td><code>uint256</code></td><td>The ID of the game</td></tr>
<tr><td><code>_rankedRewards</code></td><td><code>uint256[]</code></td><td>Array of reward percentages in basis points for each rank</td></tr>
</tbody></table>
</div>
<h3 id="getrewards"><a class="header" href="#getrewards">getRewards</a></h3>
<p>Calculates rewards for all winners in a game</p>
<pre><code class="language-solidity">function getRewards(uint256 sessionId, address[] calldata winners, uint256 prizePool)
    external
    view
    returns (uint256[] memory rewards);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>sessionId</code></td><td><code>uint256</code></td><td></td></tr>
<tr><td><code>winners</code></td><td><code>address[]</code></td><td>Array of winner addresses in order of placement (1st place first)</td></tr>
<tr><td><code>prizePool</code></td><td><code>uint256</code></td><td>The total prize pool to be distributed</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>rewards</code></td><td><code>uint256[]</code></td><td>Array of reward amounts for each winner</td></tr>
</tbody></table>
</div>
<h3 id="getreward"><a class="header" href="#getreward">getReward</a></h3>
<p>Calculates the reward for a specific position in a game</p>
<pre><code class="language-solidity">function getReward(uint256 sessionId, address[] calldata, uint256 position, uint256 prizePool)
    external
    view
    returns (uint256 reward);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>sessionId</code></td><td><code>uint256</code></td><td></td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>address[]</code></td><td></td></tr>
<tr><td><code>position</code></td><td><code>uint256</code></td><td>The position to calculate reward for (0-indexed)</td></tr>
<tr><td><code>prizePool</code></td><td><code>uint256</code></td><td>The total prize pool to be distributed</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>reward</code></td><td><code>uint256</code></td><td>The reward amount for the specified position</td></tr>
</tbody></table>
</div>
<h3 id="supportsinterface-3"><a class="header" href="#supportsinterface-3">supportsInterface</a></h3>
<pre><code class="language-solidity">function supportsInterface(bytes4 interfaceId) public view virtual override(IERC165, ERC165) returns (bool);
</code></pre>
<h2 id="events-5"><a class="header" href="#events-5">Events</a></h2>
<h3 id="rankedrewardsupdated"><a class="header" href="#rankedrewardsupdated">RankedRewardsUpdated</a></h3>
<pre><code class="language-solidity">event RankedRewardsUpdated(uint256 indexed sessionId, uint256[] rankedRewards);
</code></pre>
<h2 id="errors-5"><a class="header" href="#errors-5">Errors</a></h2>
<h3 id="rankedrewardsnotset"><a class="header" href="#rankedrewardsnotset">RankedRewardsNotSet</a></h3>
<pre><code class="language-solidity">error RankedRewardsNotSet(uint256 sessionId);
</code></pre>
<h3 id="invalidranks"><a class="header" href="#invalidranks">InvalidRanks</a></h3>
<pre><code class="language-solidity">error InvalidRanks(uint256 sessionId, uint256 numRanks);
</code></pre>
<h3 id="invalidtotalpoints"><a class="header" href="#invalidtotalpoints">InvalidTotalPoints</a></h3>
<pre><code class="language-solidity">error InvalidTotalPoints(uint256 sessionId, uint256 numPoints);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="irewardstrategy"><a class="header" href="#irewardstrategy">IRewardStrategy</a></h1>
<p><a href="https://github.com/Engage-Protocol/engage-protocol/blob/62e4edb5917eb23b13556127a45784792d64552a/src/reward/IRewardStrategy.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
IERC165</p>
<p>Interface for reward strategy contracts that determine how prize pools are distributed among winners</p>
<p><em>This interface defines the core functionality for calculating and distributing rewards
to players based on their performance in games. It extends IERC165 for interface detection support.</em></p>
<h2 id="functions-6"><a class="header" href="#functions-6">Functions</a></h2>
<h3 id="getrewards-1"><a class="header" href="#getrewards-1">getRewards</a></h3>
<p>Calculates rewards for all winners in a game</p>
<pre><code class="language-solidity">function getRewards(uint256 gameId, address[] calldata winners, uint256 prizePool)
    external
    view
    returns (uint256[] memory rewards);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>The ID of the game</td></tr>
<tr><td><code>winners</code></td><td><code>address[]</code></td><td>Array of winner addresses in order of placement (1st place first)</td></tr>
<tr><td><code>prizePool</code></td><td><code>uint256</code></td><td>The total prize pool to be distributed</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>rewards</code></td><td><code>uint256[]</code></td><td>Array of reward amounts for each winner</td></tr>
</tbody></table>
</div>
<h3 id="getreward-1"><a class="header" href="#getreward-1">getReward</a></h3>
<p>Calculates the reward for a specific position in a game</p>
<pre><code class="language-solidity">function getReward(uint256 gameId, address[] calldata winners, uint256 position, uint256 prizePool)
    external
    view
    returns (uint256 reward);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>The ID of the game</td></tr>
<tr><td><code>winners</code></td><td><code>address[]</code></td><td>Array of winner addresses in order of placement (1st place first)</td></tr>
<tr><td><code>position</code></td><td><code>uint256</code></td><td>The position to calculate reward for (0-indexed)</td></tr>
<tr><td><code>prizePool</code></td><td><code>uint256</code></td><td>The total prize pool to be distributed</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>reward</code></td><td><code>uint256</code></td><td>The reward amount for the specified position</td></tr>
</tbody></table>
</div>
<h2 id="errors-6"><a class="header" href="#errors-6">Errors</a></h2>
<h3 id="notcreator"><a class="header" href="#notcreator">NotCreator</a></h3>
<pre><code class="language-solidity">error NotCreator(uint256 sessionId, address sender);
</code></pre>
<h3 id="alreadyset"><a class="header" href="#alreadyset">AlreadySet</a></h3>
<pre><code class="language-solidity">error AlreadySet(uint256 sessionId);
</code></pre>
<h3 id="notcreated"><a class="header" href="#notcreated">NotCreated</a></h3>
<pre><code class="language-solidity">error NotCreated(uint256 sessionId);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="proportionaltoxpreward"><a class="header" href="#proportionaltoxpreward">ProportionalToXPReward</a></h1>
<p><a href="https://github.com/Engage-Protocol/engage-protocol/blob/62e4edb5917eb23b13556127a45784792d64552a/src/reward/ProportionalToXPReward.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/reward/ProportionalToXPReward.sol//src/reward/IRewardStrategy.sol/interface.IRewardStrategy.html">IRewardStrategy</a>, ERC165</p>
<p>Contract for distributing rewards proportionally based on players' XP earned</p>
<p><em>This contract implements the IRewardStrategy interface for distributing rewards
proportionally based on the total XP earned by each player. Players with higher XP
receive a larger share of the prize pool.</em></p>
<h2 id="state-variables-5"><a class="header" href="#state-variables-5">State Variables</a></h2>
<h3 id="sessionmanager-1"><a class="header" href="#sessionmanager-1">sessionManager</a></h3>
<p>Reference to the session manager contract</p>
<pre><code class="language-solidity">SessionManager public immutable sessionManager;
</code></pre>
<h3 id="numberofwinners"><a class="header" href="#numberofwinners">numberOfWinners</a></h3>
<pre><code class="language-solidity">mapping(uint256 sessionId =&gt; uint256 numberOfWinners) public numberOfWinners;
</code></pre>
<h2 id="functions-7"><a class="header" href="#functions-7">Functions</a></h2>
<h3 id="constructor-5"><a class="header" href="#constructor-5">constructor</a></h3>
<pre><code class="language-solidity">constructor(address _sessionManager);
</code></pre>
<h3 id="getrewards-2"><a class="header" href="#getrewards-2">getRewards</a></h3>
<p>Calculates rewards for all winners in a game</p>
<pre><code class="language-solidity">function getRewards(uint256 sessionId, address[] calldata winners, uint256 prizePool)
    external
    view
    returns (uint256[] memory rewards);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>sessionId</code></td><td><code>uint256</code></td><td></td></tr>
<tr><td><code>winners</code></td><td><code>address[]</code></td><td>Array of winner addresses in order of placement (1st place first)</td></tr>
<tr><td><code>prizePool</code></td><td><code>uint256</code></td><td>The total prize pool to be distributed</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>rewards</code></td><td><code>uint256[]</code></td><td>Array of reward amounts for each winner</td></tr>
</tbody></table>
</div>
<h3 id="getreward-2"><a class="header" href="#getreward-2">getReward</a></h3>
<p>Calculates the reward for a specific position in a game</p>
<pre><code class="language-solidity">function getReward(uint256 sessionId, address[] calldata winners, uint256 position, uint256 prizePool)
    external
    view
    returns (uint256 reward);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>sessionId</code></td><td><code>uint256</code></td><td></td></tr>
<tr><td><code>winners</code></td><td><code>address[]</code></td><td>Array of winner addresses in order of placement (1st place first)</td></tr>
<tr><td><code>position</code></td><td><code>uint256</code></td><td>The position to calculate reward for (0-indexed)</td></tr>
<tr><td><code>prizePool</code></td><td><code>uint256</code></td><td>The total prize pool to be distributed</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>reward</code></td><td><code>uint256</code></td><td>The reward amount for the specified position</td></tr>
</tbody></table>
</div>
<h3 id="setnumberofwinners"><a class="header" href="#setnumberofwinners">setNumberOfWinners</a></h3>
<pre><code class="language-solidity">function setNumberOfWinners(uint256 sessionId, uint256 _numberOfWinners) external;
</code></pre>
<h3 id="supportsinterface-4"><a class="header" href="#supportsinterface-4">supportsInterface</a></h3>
<pre><code class="language-solidity">function supportsInterface(bytes4 interfaceId) public view virtual override(IERC165, ERC165) returns (bool);
</code></pre>
<h2 id="errors-7"><a class="header" href="#errors-7">Errors</a></h2>
<h3 id="numberofwinnersmismatch"><a class="header" href="#numberofwinnersmismatch">NumberOfWinnersMismatch</a></h3>
<pre><code class="language-solidity">error NumberOfWinnersMismatch(uint256 sessionId, uint256 numberOfWinners);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-4"><a class="header" href="#contents-4">Contents</a></h1>
<ul>
<li><a href="src/session/DefaultSession.sol/contract.DefaultSession.html">DefaultSession</a></li>
<li><a href="src/session/ISessionStrategy.sol/interface.ISessionStrategy.html">ISessionStrategy</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="defaultsession"><a class="header" href="#defaultsession">DefaultSession</a></h1>
<p><a href="https://github.com/Engage-Protocol/engage-protocol/blob/62e4edb5917eb23b13556127a45784792d64552a/src/session/DefaultSession.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/session/DefaultSession.sol//src/session/ISessionStrategy.sol/interface.ISessionStrategy.html">ISessionStrategy</a>, ERC165, Ownable, <a href="src/session/DefaultSession.sol//src/offchain/uma/SessionResultAsserter.sol/abstract.SessionResultAsserter.html">SessionResultAsserter</a></p>
<p>Contract for managing default game sessions with XP-based scoring and winner determination</p>
<p><em>This contract implements the ISessionStrategy interface for managing game sessions.
It calculates player results based on XP earned across all questions and determines
winners based on total performance. Only the owner can record final results.</em></p>
<h2 id="state-variables-6"><a class="header" href="#state-variables-6">State Variables</a></h2>
<h3 id="resolutiongitrepoatcommithash"><a class="header" href="#resolutiongitrepoatcommithash">resolutionGitRepoAtCommitHash</a></h3>
<p>Github link to the resolution code at a certain commit hash</p>
<pre><code class="language-solidity">string public resolutionGitRepoAtCommitHash;
</code></pre>
<h3 id="sessionmanager-2"><a class="header" href="#sessionmanager-2">sessionManager</a></h3>
<pre><code class="language-solidity">address public immutable sessionManager;
</code></pre>
<h3 id="xptiers"><a class="header" href="#xptiers">xpTiers</a></h3>
<p>Array of XP tiers for different performance levels</p>
<p><em>Index 0: XP for correct answers, Index 1: XP for incorrect answers</em></p>
<pre><code class="language-solidity">mapping(uint256 gameId =&gt; uint256[]) public xpTiers;
</code></pre>
<h3 id="userresult"><a class="header" href="#userresult">userResult</a></h3>
<p>Mapping from game ID and user address to their session result</p>
<pre><code class="language-solidity">mapping(uint256 gameId =&gt; mapping(address user =&gt; SessionResult result)) public userResult;
</code></pre>
<h3 id="winners"><a class="header" href="#winners">winners</a></h3>
<p>Mapping from game ID to the list of winners</p>
<pre><code class="language-solidity">mapping(uint256 gameId =&gt; address[] winners) public winners;
</code></pre>
<h2 id="functions-8"><a class="header" href="#functions-8">Functions</a></h2>
<h3 id="constructor-6"><a class="header" href="#constructor-6">constructor</a></h3>
<p>Constructor for the DefaultSession contract</p>
<pre><code class="language-solidity">constructor(
    address _sessionManager,
    string memory _resolutionGitRepoAtCommitHash,
    address _usdc,
    address _optimisticOracle
) Ownable(msg.sender) SessionResultAsserter(_usdc, _optimisticOracle);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_sessionManager</code></td><td><code>address</code></td><td>The address of the session manager contract</td></tr>
<tr><td><code>_resolutionGitRepoAtCommitHash</code></td><td><code>string</code></td><td>The Github link to the resolution code at a certain commit hash</td></tr>
<tr><td><code>_usdc</code></td><td><code>address</code></td><td>The address of the USDC token</td></tr>
<tr><td><code>_optimisticOracle</code></td><td><code>address</code></td><td>The address of the Optimistic Oracle contract</td></tr>
</tbody></table>
</div>
<h3 id="getwinners"><a class="header" href="#getwinners">getWinners</a></h3>
<p>Gets the list of winners for a specific game</p>
<pre><code class="language-solidity">function getWinners(uint256 gameId) public view returns (address[] memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>The ID of the game</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address[]</code></td><td>Array of winner addresses in order of placement (1st place first)</td></tr>
</tbody></table>
</div>
<h3 id="getxptiers"><a class="header" href="#getxptiers">getXPTiers</a></h3>
<p>Gets the XP tiers for different performance levels</p>
<pre><code class="language-solidity">function getXPTiers(uint256 gameId) public view returns (uint256[] memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>The ID of the game</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256[]</code></td><td>Array of XP amounts for each tier</td></tr>
</tbody></table>
</div>
<h3 id="setxptiers"><a class="header" href="#setxptiers">setXPTiers</a></h3>
<pre><code class="language-solidity">function setXPTiers(uint256 gameId, uint256[] memory _xpTiers) external;
</code></pre>
<h3 id="_calculateplayersessionresult"><a class="header" href="#_calculateplayersessionresult">_calculatePlayerSessionResult</a></h3>
<p>Calculate a player's total XP and time across all prompts in a session</p>
<pre><code class="language-solidity">function _calculatePlayerSessionResult(uint256 gameId, address player)
    internal
    view
    returns (uint256 totalXP, uint256 totalTime);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>The game ID</td></tr>
<tr><td><code>player</code></td><td><code>address</code></td><td>The player's address</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>totalXP</code></td><td><code>uint256</code></td><td>The total XP earned by the player across all questions</td></tr>
<tr><td><code>totalTime</code></td><td><code>uint256</code></td><td>The total time taken by the player across all questions</td></tr>
</tbody></table>
</div>
<h3 id="assertresults"><a class="header" href="#assertresults">assertResults</a></h3>
<p>Assert the results for a session</p>
<pre><code class="language-solidity">function assertResults(
    uint256 sessionId,
    string calldata resultCid,
    address[] calldata proposedWinners,
    uint256[] calldata totalXPs,
    uint256[] calldata totalTimes
) external returns (bytes32 assertionId);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>sessionId</code></td><td><code>uint256</code></td><td>The session ID</td></tr>
<tr><td><code>resultCid</code></td><td><code>string</code></td><td>The result CID containing results for <strong>all</strong> participants in the session</td></tr>
<tr><td><code>proposedWinners</code></td><td><code>address[]</code></td><td>The proposed winners</td></tr>
<tr><td><code>totalXPs</code></td><td><code>uint256[]</code></td><td>The total XP for each winner</td></tr>
<tr><td><code>totalTimes</code></td><td><code>uint256[]</code></td><td>The total time for each winner</td></tr>
</tbody></table>
</div>
<h3 id="recordresults"><a class="header" href="#recordresults">recordResults</a></h3>
<p>Record the results for a session</p>
<pre><code class="language-solidity">function recordResults(uint256 sessionId, bytes32 assertionId) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>sessionId</code></td><td><code>uint256</code></td><td>The session ID</td></tr>
<tr><td><code>assertionId</code></td><td><code>bytes32</code></td><td>The assertion ID</td></tr>
</tbody></table>
</div>
<h3 id="calculatexp"><a class="header" href="#calculatexp">calculateXP</a></h3>
<p>Calculates the XP reward for a specific pick position</p>
<pre><code class="language-solidity">function calculateXP(uint256 gameId, uint256 pickPosition) public view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>The ID of the game</td></tr>
<tr><td><code>pickPosition</code></td><td><code>uint256</code></td><td>The position of the player's pick (0-indexed)</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The XP amount to be awarded</td></tr>
</tbody></table>
</div>
<h3 id="supportsinterface-5"><a class="header" href="#supportsinterface-5">supportsInterface</a></h3>
<pre><code class="language-solidity">function supportsInterface(bytes4 interfaceId) public view override(IERC165, ERC165) returns (bool);
</code></pre>
<h2 id="events-6"><a class="header" href="#events-6">Events</a></h2>
<h3 id="xptiersupdated"><a class="header" href="#xptiersupdated">XpTiersUpdated</a></h3>
<pre><code class="language-solidity">event XpTiersUpdated(uint256 indexed gameId, uint256[] xpTiers);
</code></pre>
<h2 id="errors-8"><a class="header" href="#errors-8">Errors</a></h2>
<h3 id="arraylengthmismatch"><a class="header" href="#arraylengthmismatch">ArrayLengthMismatch</a></h3>
<pre><code class="language-solidity">error ArrayLengthMismatch();
</code></pre>
<h3 id="maxrewardedplayersexceeded"><a class="header" href="#maxrewardedplayersexceeded">MaxRewardedPlayersExceeded</a></h3>
<pre><code class="language-solidity">error MaxRewardedPlayersExceeded(uint256 rewardedPlayers);
</code></pre>
<h3 id="gamenotended"><a class="header" href="#gamenotended">GameNotEnded</a></h3>
<pre><code class="language-solidity">error GameNotEnded();
</code></pre>
<h3 id="playernotbetterthanclaimed"><a class="header" href="#playernotbetterthanclaimed">PlayerNotBetterThanClaimed</a></h3>
<pre><code class="language-solidity">error PlayerNotBetterThanClaimed();
</code></pre>
<h3 id="incorrectplayerdata"><a class="header" href="#incorrectplayerdata">IncorrectPlayerData</a></h3>
<pre><code class="language-solidity">error IncorrectPlayerData();
</code></pre>
<h3 id="gamenotcreated"><a class="header" href="#gamenotcreated">GameNotCreated</a></h3>
<pre><code class="language-solidity">error GameNotCreated(uint256 gameId);
</code></pre>
<h3 id="notgamecreator"><a class="header" href="#notgamecreator">NotGameCreator</a></h3>
<pre><code class="language-solidity">error NotGameCreator(address creator, address caller);
</code></pre>
<h3 id="assertionnotinitialized"><a class="header" href="#assertionnotinitialized">AssertionNotInitialized</a></h3>
<pre><code class="language-solidity">error AssertionNotInitialized(bytes32 assertionId);
</code></pre>
<h3 id="sessionidmismatch"><a class="header" href="#sessionidmismatch">SessionIdMismatch</a></h3>
<pre><code class="language-solidity">error SessionIdMismatch(uint256 sessionId, uint256 assertionSessionId);
</code></pre>
<h2 id="structs-4"><a class="header" href="#structs-4">Structs</a></h2>
<h3 id="sessionresult"><a class="header" href="#sessionresult">SessionResult</a></h3>
<p>Structure containing a player's complete session result</p>
<pre><code class="language-solidity">struct SessionResult {
    uint256 placement;
    uint256 xp;
    uint256 time;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>placement</code></td><td><code>uint256</code></td><td>The player's final placement in the game</td></tr>
<tr><td><code>xp</code></td><td><code>uint256</code></td><td>The total XP earned by the player across all questions</td></tr>
<tr><td><code>time</code></td><td><code>uint256</code></td><td>The total time taken by the player across all questions</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="isessionstrategy"><a class="header" href="#isessionstrategy">ISessionStrategy</a></h1>
<p><a href="https://github.com/Engage-Protocol/engage-protocol/blob/62e4edb5917eb23b13556127a45784792d64552a/src/session/ISessionStrategy.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
IERC165</p>
<p>Interface for session strategy contracts that manage game sessions and player results</p>
<p><em>This interface defines the core functionality for managing game sessions, calculating
player results, and determining winners. It extends IERC165 for interface detection support.</em></p>
<h2 id="functions-9"><a class="header" href="#functions-9">Functions</a></h2>
<h3 id="sessionmanager-3"><a class="header" href="#sessionmanager-3">sessionManager</a></h3>
<p>Gets the address of the session manager</p>
<p><em>This is used to check if the session strategy is compatible with the session manager</em></p>
<pre><code class="language-solidity">function sessionManager() external view returns (address);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>The address of the session manager</td></tr>
</tbody></table>
</div>
<h3 id="getwinners-1"><a class="header" href="#getwinners-1">getWinners</a></h3>
<p>Gets the list of winners for a specific game</p>
<pre><code class="language-solidity">function getWinners(uint256 gameId) external view returns (address[] memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>The ID of the game</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address[]</code></td><td>Array of winner addresses in order of placement (1st place first)</td></tr>
</tbody></table>
</div>
<h3 id="calculatexp-1"><a class="header" href="#calculatexp-1">calculateXP</a></h3>
<p>Calculates the XP reward for a specific pick position</p>
<pre><code class="language-solidity">function calculateXP(uint256 gameId, uint256 pickPosition) external view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>The ID of the game</td></tr>
<tr><td><code>pickPosition</code></td><td><code>uint256</code></td><td>The position of the player's pick (0-indexed)</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The XP amount to be awarded</td></tr>
</tbody></table>
</div>
<h3 id="getxptiers-1"><a class="header" href="#getxptiers-1">getXPTiers</a></h3>
<p>Gets the XP tiers for different performance levels</p>
<pre><code class="language-solidity">function getXPTiers(uint256 gameId) external view returns (uint256[] memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>The ID of the game</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256[]</code></td><td>Array of XP amounts for each tier</td></tr>
</tbody></table>
</div>
<h3 id="assertresults-1"><a class="header" href="#assertresults-1">assertResults</a></h3>
<p>Assert the results for a session</p>
<pre><code class="language-solidity">function assertResults(
    uint256 sessionId,
    string calldata resultCid,
    address[] calldata proposedWinners,
    uint256[] calldata totalXPs,
    uint256[] calldata totalTimes
) external returns (bytes32 assertionId);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>sessionId</code></td><td><code>uint256</code></td><td>The session ID</td></tr>
<tr><td><code>resultCid</code></td><td><code>string</code></td><td>The result CID containing results for <strong>all</strong> participants in the session</td></tr>
<tr><td><code>proposedWinners</code></td><td><code>address[]</code></td><td>The proposed winners</td></tr>
<tr><td><code>totalXPs</code></td><td><code>uint256[]</code></td><td>The total XP for each winner</td></tr>
<tr><td><code>totalTimes</code></td><td><code>uint256[]</code></td><td>The total time for each winner</td></tr>
</tbody></table>
</div>
<h3 id="recordresults-1"><a class="header" href="#recordresults-1">recordResults</a></h3>
<p>Record the results for a session</p>
<pre><code class="language-solidity">function recordResults(uint256 sessionId, bytes32 assertionId) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>sessionId</code></td><td><code>uint256</code></td><td>The session ID</td></tr>
<tr><td><code>assertionId</code></td><td><code>bytes32</code></td><td>The assertion ID</td></tr>
</tbody></table>
</div>
<h3 id="userresult-1"><a class="header" href="#userresult-1">userResult</a></h3>
<p>Gets the complete result for a player in a game</p>
<pre><code class="language-solidity">function userResult(uint256 gameId, address userAddress)
    external
    view
    returns (uint256 placement, uint256 xp, uint256 time);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>The ID of the game</td></tr>
<tr><td><code>userAddress</code></td><td><code>address</code></td><td>The address of the player</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>placement</code></td><td><code>uint256</code></td><td>The player's final placement in the game</td></tr>
<tr><td><code>xp</code></td><td><code>uint256</code></td><td>The total XP earned by the player</td></tr>
<tr><td><code>time</code></td><td><code>uint256</code></td><td>The total time taken by the player across all questions</td></tr>
</tbody></table>
</div>
<h2 id="events-7"><a class="header" href="#events-7">Events</a></h2>
<h3 id="answercommitted-1"><a class="header" href="#answercommitted-1">AnswerCommitted</a></h3>
<pre><code class="language-solidity">event AnswerCommitted(uint256 indexed gameId, uint256 indexed questionId, address indexed player, bytes32 commit);
</code></pre>
<h3 id="playerplaced"><a class="header" href="#playerplaced">PlayerPlaced</a></h3>
<pre><code class="language-solidity">event PlayerPlaced(uint256 indexed gameId, address indexed player, uint256 indexed placement);
</code></pre>
<h2 id="errors-9"><a class="header" href="#errors-9">Errors</a></h2>
<h3 id="onlysessionmanager-1"><a class="header" href="#onlysessionmanager-1">OnlySessionManager</a></h3>
<pre><code class="language-solidity">error OnlySessionManager(address caller);
</code></pre>
<h3 id="invalidgamestate-1"><a class="header" href="#invalidgamestate-1">InvalidGameState</a></h3>
<pre><code class="language-solidity">error InvalidGameState(SessionState expected, SessionState actual);
</code></pre>
<h3 id="playernotcontestant-1"><a class="header" href="#playernotcontestant-1">PlayerNotContestant</a></h3>
<pre><code class="language-solidity">error PlayerNotContestant(address player);
</code></pre>
<h3 id="answeralreadycommitted-1"><a class="header" href="#answeralreadycommitted-1">AnswerAlreadyCommitted</a></h3>
<pre><code class="language-solidity">error AnswerAlreadyCommitted(address player, uint256 gameId, uint256 questionId);
</code></pre>
<h3 id="answernotcommitted-1"><a class="header" href="#answernotcommitted-1">AnswerNotCommitted</a></h3>
<pre><code class="language-solidity">error AnswerNotCommitted(address player, uint256 gameId, uint256 questionId);
</code></pre>
<h3 id="answeralreadyrevealed-1"><a class="header" href="#answeralreadyrevealed-1">AnswerAlreadyRevealed</a></h3>
<pre><code class="language-solidity">error AnswerAlreadyRevealed(address player, uint256 gameId, uint256 questionId);
</code></pre>
<h3 id="invalidquestionid-1"><a class="header" href="#invalidquestionid-1">InvalidQuestionId</a></h3>
<pre><code class="language-solidity">error InvalidQuestionId(uint256 questionId);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="depositmanager"><a class="header" href="#depositmanager">DepositManager</a></h1>
<p><a href="https://github.com/Engage-Protocol/engage-protocol/blob/62e4edb5917eb23b13556127a45784792d64552a/src/DepositManager.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/DepositManager.sol//src/SessionManagerBase.sol/abstract.SessionManagerBase.html">SessionManagerBase</a></p>
<p>Manages deposits, fees, and rewards for sessions</p>
<p><em>Supports both entry fees and sponsor contributions</em></p>
<p><em>Implements a referral system with rewards</em></p>
<h2 id="state-variables-7"><a class="header" href="#state-variables-7">State Variables</a></h2>
<h3 id="gamepools"><a class="header" href="#gamepools">gamePools</a></h3>
<p>Mapping of session ID to its prize pool and fee configuration</p>
<pre><code class="language-solidity">mapping(uint256 gameId =&gt; GamePool pool) public gamePools;
</code></pre>
<h3 id="hasclaimed"><a class="header" href="#hasclaimed">hasClaimed</a></h3>
<p>Mapping of game ID and player address to whether they have claimed their reward</p>
<pre><code class="language-solidity">mapping(uint256 =&gt; mapping(address =&gt; bool)) public hasClaimed;
</code></pre>
<h3 id="hasrefunded"><a class="header" href="#hasrefunded">hasRefunded</a></h3>
<p>Mapping of game ID and player address to whether they have received a refund</p>
<pre><code class="language-solidity">mapping(uint256 =&gt; mapping(address =&gt; bool)) public hasRefunded;
</code></pre>
<h3 id="sponsoramounts"><a class="header" href="#sponsoramounts">sponsorAmounts</a></h3>
<p>Mapping of sponsor address and game ID to the amount they sponsored</p>
<pre><code class="language-solidity">mapping(address sponsor =&gt; mapping(uint256 gameId =&gt; uint256 amount)) public sponsorAmounts;
</code></pre>
<h3 id="referralrewards"><a class="header" href="#referralrewards">referralRewards</a></h3>
<p>Mapping of game ID and referrer address to their referral reward amount</p>
<pre><code class="language-solidity">mapping(uint256 gameId =&gt; mapping(address referrer =&gt; uint256 referralReward)) public referralRewards;
</code></pre>
<h3 id="protocolfee"><a class="header" href="#protocolfee">protocolFee</a></h3>
<p>Protocol fee percentage in basis points</p>
<pre><code class="language-solidity">uint256 public protocolFee = 500;
</code></pre>
<h3 id="maxcreatorfee"><a class="header" href="#maxcreatorfee">maxCreatorFee</a></h3>
<p>Maximum allowed creator fee percentage in basis points</p>
<pre><code class="language-solidity">uint256 public maxCreatorFee = 1000;
</code></pre>
<h3 id="referrer_fee"><a class="header" href="#referrer_fee">REFERRER_FEE</a></h3>
<p>Referrer fee percentage in basis points</p>
<pre><code class="language-solidity">uint256 public constant REFERRER_FEE = 200;
</code></pre>
<h3 id="max_game_fees"><a class="header" href="#max_game_fees">MAX_GAME_FEES</a></h3>
<p>Maximum total fees allowed in basis points</p>
<pre><code class="language-solidity">uint256 public constant MAX_GAME_FEES = 3000;
</code></pre>
<h3 id="basis_points-1"><a class="header" href="#basis_points-1">BASIS_POINTS</a></h3>
<p>Basis points denominator (10000 = 100%)</p>
<pre><code class="language-solidity">uint256 public constant BASIS_POINTS = 10000;
</code></pre>
<h2 id="functions-10"><a class="header" href="#functions-10">Functions</a></h2>
<h3 id="constructor-7"><a class="header" href="#constructor-7">constructor</a></h3>
<pre><code class="language-solidity">constructor(address _registry) SessionManagerBase(_registry);
</code></pre>
<h3 id="getrewards-3"><a class="header" href="#getrewards-3">getRewards</a></h3>
<p>Calculates the total rewards available for distribution to winners</p>
<pre><code class="language-solidity">function getRewards(uint256 gameId) public view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>The ID of the session</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The amount of tokens available for rewards after deducting fees</td></tr>
</tbody></table>
</div>
<h3 id="sponsorgame"><a class="header" href="#sponsorgame">sponsorGame</a></h3>
<p>Allows a sponsor to add funds to a session's prize pool</p>
<pre><code class="language-solidity">function sponsorGame(uint256 gameId, uint256 amount) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>The ID of the session to sponsor</td></tr>
<tr><td><code>amount</code></td><td><code>uint256</code></td><td>The amount of tokens to sponsor</td></tr>
</tbody></table>
</div>
<h3 id="_claimreferralreward"><a class="header" href="#_claimreferralreward">_claimReferralReward</a></h3>
<pre><code class="language-solidity">function _claimReferralReward(uint256 gameId) internal;
</code></pre>
<h3 id="_distributefees"><a class="header" href="#_distributefees">_distributeFees</a></h3>
<pre><code class="language-solidity">function _distributeFees(uint256 gameId, address creator, address protocolTreasury) internal;
</code></pre>
<h3 id="_refundsponsorfunds"><a class="header" href="#_refundsponsorfunds">_refundSponsorFunds</a></h3>
<pre><code class="language-solidity">function _refundSponsorFunds(uint256 gameId, address sponsor) internal;
</code></pre>
<h3 id="_distributerewards"><a class="header" href="#_distributerewards">_distributeRewards</a></h3>
<pre><code class="language-solidity">function _distributeRewards(uint256 gameId, address winner, uint256 reward) internal;
</code></pre>
<h3 id="_refundentryfee"><a class="header" href="#_refundentryfee">_refundEntryFee</a></h3>
<pre><code class="language-solidity">function _refundEntryFee(uint256 gameId, address player) internal;
</code></pre>
<h3 id="_payentryfee"><a class="header" href="#_payentryfee">_payEntryFee</a></h3>
<pre><code class="language-solidity">function _payEntryFee(uint256 gameId, address player) internal;
</code></pre>
<h3 id="_creategamepool"><a class="header" href="#_creategamepool">_createGamePool</a></h3>
<pre><code class="language-solidity">function _createGamePool(uint256 gameId, uint256 _ticketPrice, uint256 _creatorFee, address _token) internal;
</code></pre>
<h3 id="setmaxfees"><a class="header" href="#setmaxfees">setMaxFees</a></h3>
<p>Sets the maximum allowed creator fee and protocol fee percentages</p>
<p><em>Only callable by the contract owner</em></p>
<p><em>The sum of fees cannot exceed MAX_GAME_FEES</em></p>
<pre><code class="language-solidity">function setMaxFees(uint256 _maxCreatorFee, uint256 _protocolFee) external onlyRole(PROTOCOL_ADMIN_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_maxCreatorFee</code></td><td><code>uint256</code></td><td>The new maximum creator fee percentage in basis points</td></tr>
<tr><td><code>_protocolFee</code></td><td><code>uint256</code></td><td>The new protocol fee percentage in basis points</td></tr>
</tbody></table>
</div>
<h2 id="events-8"><a class="header" href="#events-8">Events</a></h2>
<h3 id="feesdistributed"><a class="header" href="#feesdistributed">FeesDistributed</a></h3>
<pre><code class="language-solidity">event FeesDistributed(
    uint256 indexed gameId,
    address token,
    address indexed creator,
    uint256 creatorFee,
    address protocolTreasury,
    uint256 protocolFee
);
</code></pre>
<h3 id="deposit"><a class="header" href="#deposit">Deposit</a></h3>
<pre><code class="language-solidity">event Deposit(address indexed player, uint256 amount);
</code></pre>
<h3 id="gamesponsored"><a class="header" href="#gamesponsored">GameSponsored</a></h3>
<pre><code class="language-solidity">event GameSponsored(uint256 indexed gameId, address indexed sponsor, address token, uint256 amount);
</code></pre>
<h3 id="refundsponsorfunds"><a class="header" href="#refundsponsorfunds">RefundSponsorFunds</a></h3>
<pre><code class="language-solidity">event RefundSponsorFunds(uint256 indexed gameId, address indexed sponsor, address token, uint256 amount);
</code></pre>
<h3 id="maxfeesset"><a class="header" href="#maxfeesset">MaxFeesSet</a></h3>
<pre><code class="language-solidity">event MaxFeesSet(uint256 maxCreatorFee, uint256 protocolFee);
</code></pre>
<h3 id="referralrewardclaimed"><a class="header" href="#referralrewardclaimed">ReferralRewardClaimed</a></h3>
<pre><code class="language-solidity">event ReferralRewardClaimed(uint256 indexed gameId, address indexed referrer, address indexed token, uint256 amount);
</code></pre>
<h2 id="errors-10"><a class="header" href="#errors-10">Errors</a></h2>
<h3 id="insufficientbalance"><a class="header" href="#insufficientbalance">InsufficientBalance</a></h3>
<pre><code class="language-solidity">error InsufficientBalance(address player, address token, uint256 balance, uint256 required);
</code></pre>
<h3 id="alreadyclaimed"><a class="header" href="#alreadyclaimed">AlreadyClaimed</a></h3>
<pre><code class="language-solidity">error AlreadyClaimed(address player, uint256 gameId);
</code></pre>
<h3 id="feesalreadypaid"><a class="header" href="#feesalreadypaid">FeesAlreadyPaid</a></h3>
<pre><code class="language-solidity">error FeesAlreadyPaid(uint256 gameId);
</code></pre>
<h3 id="norewardavailable"><a class="header" href="#norewardavailable">NoRewardAvailable</a></h3>
<pre><code class="language-solidity">error NoRewardAvailable(uint256 gameId);
</code></pre>
<h3 id="notenoughfunds"><a class="header" href="#notenoughfunds">NotEnoughFunds</a></h3>
<pre><code class="language-solidity">error NotEnoughFunds(address token, uint256 balance);
</code></pre>
<h3 id="alreadyrefunded"><a class="header" href="#alreadyrefunded">AlreadyRefunded</a></h3>
<pre><code class="language-solidity">error AlreadyRefunded(address player, uint256 gameId);
</code></pre>
<h3 id="invalidcreatorfee"><a class="header" href="#invalidcreatorfee">InvalidCreatorFee</a></h3>
<pre><code class="language-solidity">error InvalidCreatorFee(uint256 creatorFee, uint256 maxCreatorFee);
</code></pre>
<h3 id="invalidmaxfees"><a class="header" href="#invalidmaxfees">InvalidMaxFees</a></h3>
<pre><code class="language-solidity">error InvalidMaxFees(uint256 maxCreatorFee, uint256 protocolFee);
</code></pre>
<h2 id="structs-5"><a class="header" href="#structs-5">Structs</a></h2>
<h3 id="gamepool"><a class="header" href="#gamepool">GamePool</a></h3>
<p>Represents a session's prize pool and fee configuration</p>
<pre><code class="language-solidity">struct GamePool {
    uint256 gameId;
    uint256 ticketPrice;
    uint256 creatorFee;
    uint256 protocolFee;
    uint256 totalCollectedAmount;
    address token;
    bool feesPaid;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>Unique identifier for the session</td></tr>
<tr><td><code>ticketPrice</code></td><td><code>uint256</code></td><td>Price for each participant to join the session</td></tr>
<tr><td><code>creatorFee</code></td><td><code>uint256</code></td><td>Percentage of fees that go to the session creator (in basis points)</td></tr>
<tr><td><code>protocolFee</code></td><td><code>uint256</code></td><td>Percentage of fees that go to the protocol (in basis points)</td></tr>
<tr><td><code>totalCollectedAmount</code></td><td><code>uint256</code></td><td>Total amount of tokens collected in the pool</td></tr>
<tr><td><code>token</code></td><td><code>address</code></td><td>Address of the token used for payments</td></tr>
<tr><td><code>feesPaid</code></td><td><code>bool</code></td><td>Whether the creator and protocol fees have been distributed</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="questionmanager"><a class="header" href="#questionmanager">QuestionManager</a></h1>
<p><a href="https://github.com/Engage-Protocol/engage-protocol/blob/62e4edb5917eb23b13556127a45784792d64552a/src/QuestionManager.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/QuestionManager.sol//src/DepositManager.sol/abstract.DepositManager.html">DepositManager</a></p>
<p>Manages commit and reveal of questions for a session</p>
<p><em>Handles the secure storage and verification of questions through a commit-reveal scheme</em></p>
<p><em>Questions are committed before the session starts and revealed during the session</em></p>
<p><em>Each question is associated with a prompt strategy that implements specific question logic</em></p>
<h2 id="state-variables-8"><a class="header" href="#state-variables-8">State Variables</a></h2>
<h3 id="nextquestionid"><a class="header" href="#nextquestionid">nextQuestionId</a></h3>
<pre><code class="language-solidity">uint256 public nextQuestionId;
</code></pre>
<h3 id="gamequestions"><a class="header" href="#gamequestions">gameQuestions</a></h3>
<pre><code class="language-solidity">mapping(uint256 =&gt; uint256[]) public gameQuestions;
</code></pre>
<h3 id="questioncommitment"><a class="header" href="#questioncommitment">questionCommitment</a></h3>
<pre><code class="language-solidity">mapping(uint256 =&gt; PromptInitData) public questionCommitment;
</code></pre>
<h2 id="functions-11"><a class="header" href="#functions-11">Functions</a></h2>
<h3 id="constructor-8"><a class="header" href="#constructor-8">constructor</a></h3>
<pre><code class="language-solidity">constructor(address _registry) DepositManager(_registry);
</code></pre>
<h3 id="_commitquestions"><a class="header" href="#_commitquestions">_commitQuestions</a></h3>
<p>Commit questions before the game starts to ensure integrity</p>
<pre><code class="language-solidity">function _commitQuestions(uint256 _gameId, bytes32[] memory _questionHashes, address[] memory _promptStrategies)
    internal;
</code></pre>
<h3 id="_revealprompt"><a class="header" href="#_revealprompt">_revealPrompt</a></h3>
<pre><code class="language-solidity">function _revealPrompt(uint256 _gameId, uint256 _questionId, bytes memory _prompt, uint256 _salt) internal;
</code></pre>
<h3 id="_isrevealed"><a class="header" href="#_isrevealed">_isRevealed</a></h3>
<pre><code class="language-solidity">function _isRevealed(uint256 _questionId) internal view returns (bool);
</code></pre>
<h3 id="isrevealed-4"><a class="header" href="#isrevealed-4">isRevealed</a></h3>
<pre><code class="language-solidity">function isRevealed(uint256 _questionId) external view returns (bool);
</code></pre>
<h3 id="getquestionsforgame"><a class="header" href="#getquestionsforgame">getQuestionsForGame</a></h3>
<p>Retrieve all question IDs for a given game</p>
<pre><code class="language-solidity">function getQuestionsForGame(uint256 _gameId) external view returns (uint256[] memory);
</code></pre>
<h2 id="events-9"><a class="header" href="#events-9">Events</a></h2>
<h3 id="questioncommitted"><a class="header" href="#questioncommitted">QuestionCommitted</a></h3>
<pre><code class="language-solidity">event QuestionCommitted(uint256 indexed gameId, uint256 indexed questionId, bytes32 promptHash, address promptStrategy);
</code></pre>
<h3 id="questionrevealed"><a class="header" href="#questionrevealed">QuestionRevealed</a></h3>
<pre><code class="language-solidity">event QuestionRevealed(uint256 indexed gameId, uint256 indexed questionId, bytes prompt);
</code></pre>
<h2 id="errors-11"><a class="header" href="#errors-11">Errors</a></h2>
<h3 id="gamequestionsalreadycommitted"><a class="header" href="#gamequestionsalreadycommitted">GameQuestionsAlreadyCommitted</a></h3>
<pre><code class="language-solidity">error GameQuestionsAlreadyCommitted(uint256 gameId);
</code></pre>
<h3 id="invalidquestionreveal"><a class="header" href="#invalidquestionreveal">InvalidQuestionReveal</a></h3>
<pre><code class="language-solidity">error InvalidQuestionReveal(uint256 gameId, uint256 questionId);
</code></pre>
<h3 id="invalidquestionhash"><a class="header" href="#invalidquestionhash">InvalidQuestionHash</a></h3>
<pre><code class="language-solidity">error InvalidQuestionHash(uint256 gameId, uint256 questionId);
</code></pre>
<h3 id="questionalreadyrevealed"><a class="header" href="#questionalreadyrevealed">QuestionAlreadyRevealed</a></h3>
<pre><code class="language-solidity">error QuestionAlreadyRevealed(uint256 gameId, uint256 questionId);
</code></pre>
<h3 id="questionalreadycommitted"><a class="header" href="#questionalreadycommitted">QuestionAlreadyCommitted</a></h3>
<pre><code class="language-solidity">error QuestionAlreadyCommitted(uint256 gameId, uint256 questionId);
</code></pre>
<h3 id="emptyarray"><a class="header" href="#emptyarray">EmptyArray</a></h3>
<pre><code class="language-solidity">error EmptyArray();
</code></pre>
<h2 id="structs-6"><a class="header" href="#structs-6">Structs</a></h2>
<h3 id="promptinitdata"><a class="header" href="#promptinitdata">PromptInitData</a></h3>
<p>Represents the initialization data for a question prompt</p>
<pre><code class="language-solidity">struct PromptInitData {
    bytes32 promptHash;
    address promptStrategy;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>promptHash</code></td><td><code>bytes32</code></td><td>Hash of the question prompt and its salt</td></tr>
<tr><td><code>promptStrategy</code></td><td><code>address</code></td><td>Address of the contract implementing the prompt strategy logic</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="registry-3"><a class="header" href="#registry-3">Registry</a></h1>
<p><a href="https://github.com/Engage-Protocol/engage-protocol/blob/62e4edb5917eb23b13556127a45784792d64552a/src/Registry.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
AccessControl</p>
<p>Registry contract for managing the protocol's components which are allowed to be used in a new session</p>
<h2 id="state-variables-9"><a class="header" href="#state-variables-9">State Variables</a></h2>
<h3 id="promptstrategies"><a class="header" href="#promptstrategies">promptStrategies</a></h3>
<pre><code class="language-solidity">mapping(address =&gt; bool) public promptStrategies;
</code></pre>
<h3 id="sessionstrategies"><a class="header" href="#sessionstrategies">sessionStrategies</a></h3>
<pre><code class="language-solidity">mapping(address =&gt; bool) public sessionStrategies;
</code></pre>
<h3 id="rewardstrategies"><a class="header" href="#rewardstrategies">rewardStrategies</a></h3>
<pre><code class="language-solidity">mapping(address =&gt; bool) public rewardStrategies;
</code></pre>
<h3 id="paymenttokens"><a class="header" href="#paymenttokens">paymentTokens</a></h3>
<pre><code class="language-solidity">mapping(address =&gt; bool) public paymentTokens;
</code></pre>
<h3 id="engageprotocols"><a class="header" href="#engageprotocols">engageProtocols</a></h3>
<pre><code class="language-solidity">mapping(address =&gt; bool) public engageProtocols;
</code></pre>
<h3 id="referrers"><a class="header" href="#referrers">referrers</a></h3>
<p>Mapping of player address to their referrer</p>
<pre><code class="language-solidity">mapping(address player =&gt; address referrer) public referrers;
</code></pre>
<h3 id="protocoltreasury"><a class="header" href="#protocoltreasury">protocolTreasury</a></h3>
<pre><code class="language-solidity">address public protocolTreasury;
</code></pre>
<h2 id="functions-12"><a class="header" href="#functions-12">Functions</a></h2>
<h3 id="constructor-9"><a class="header" href="#constructor-9">constructor</a></h3>
<p>Initializes the Registry contract</p>
<pre><code class="language-solidity">constructor(address _protocolTreasury);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_protocolTreasury</code></td><td><code>address</code></td><td>The address of the protocol treasury</td></tr>
</tbody></table>
</div>
<h3 id="registersessionstrategy"><a class="header" href="#registersessionstrategy">registerSessionStrategy</a></h3>
<p>Registers or updates a session strategy contract which can be used in a new session</p>
<p><em>Verifies that the contract implements ISessionStrategy interface</em></p>
<pre><code class="language-solidity">function registerSessionStrategy(address _sessionStrategy, bool enabled) external onlyRole(PROTOCOL_ADMIN_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_sessionStrategy</code></td><td><code>address</code></td><td>The address of the session strategy contract</td></tr>
<tr><td><code>enabled</code></td><td><code>bool</code></td><td>Whether the session strategy should be enabled or disabled</td></tr>
</tbody></table>
</div>
<h3 id="registerpromptstrategy"><a class="header" href="#registerpromptstrategy">registerPromptStrategy</a></h3>
<p>Registers or updates a prompt strategy contract which can be used in a new session</p>
<p><em>Verifies that the contract implements IPromptStrategy interface</em></p>
<pre><code class="language-solidity">function registerPromptStrategy(address _promptStrategy, bool enabled) external onlyRole(PROTOCOL_ADMIN_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_promptStrategy</code></td><td><code>address</code></td><td>The address of the prompt strategy contract</td></tr>
<tr><td><code>enabled</code></td><td><code>bool</code></td><td>Whether the prompt strategy should be enabled or disabled</td></tr>
</tbody></table>
</div>
<h3 id="registerrewardstrategy"><a class="header" href="#registerrewardstrategy">registerRewardStrategy</a></h3>
<p>Registers or updates a reward strategy contract which can be used in a new session</p>
<p><em>Verifies that the contract implements IRewardStrategy interface</em></p>
<pre><code class="language-solidity">function registerRewardStrategy(address _rewardStrategy, bool enabled) external onlyRole(PROTOCOL_ADMIN_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rewardStrategy</code></td><td><code>address</code></td><td>The address of the reward strategy contract</td></tr>
<tr><td><code>enabled</code></td><td><code>bool</code></td><td>Whether the reward strategy should be enabled or disabled</td></tr>
</tbody></table>
</div>
<h3 id="registerpaymenttoken"><a class="header" href="#registerpaymenttoken">registerPaymentToken</a></h3>
<p>Registers or updates a payment token</p>
<pre><code class="language-solidity">function registerPaymentToken(address _paymentToken, bool enabled) external onlyRole(PROTOCOL_ADMIN_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_paymentToken</code></td><td><code>address</code></td><td>The address of the payment token contract</td></tr>
<tr><td><code>enabled</code></td><td><code>bool</code></td><td>Whether the payment token should be enabled or disabled</td></tr>
</tbody></table>
</div>
<h3 id="registerengageprotocol"><a class="header" href="#registerengageprotocol">registerEngageProtocol</a></h3>
<p>Registers a new version of the engage protocol contract</p>
<pre><code class="language-solidity">function registerEngageProtocol(address _engageProtocol) external onlyRole(PROTOCOL_ADMIN_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_engageProtocol</code></td><td><code>address</code></td><td>The address of the engage protocol contract</td></tr>
</tbody></table>
</div>
<h3 id="setprotocoltreasury"><a class="header" href="#setprotocoltreasury">setProtocolTreasury</a></h3>
<p>Sets the protocol treasury address</p>
<pre><code class="language-solidity">function setProtocolTreasury(address _protocolTreasury) public onlyRole(PROTOCOL_ADMIN_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_protocolTreasury</code></td><td><code>address</code></td><td>The address of the protocol treasury</td></tr>
</tbody></table>
</div>
<h3 id="setreferrer"><a class="header" href="#setreferrer">setReferrer</a></h3>
<p>Sets a referrer for a player</p>
<p><em>A player cannot refer themselves</em></p>
<pre><code class="language-solidity">function setReferrer(address player, address referrer) external onlyRole(ADMIN_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>player</code></td><td><code>address</code></td><td>The address of the player</td></tr>
<tr><td><code>referrer</code></td><td><code>address</code></td><td>The address of the referrer</td></tr>
</tbody></table>
</div>
<h2 id="events-10"><a class="header" href="#events-10">Events</a></h2>
<h3 id="sessionstrategyregistered"><a class="header" href="#sessionstrategyregistered">SessionStrategyRegistered</a></h3>
<pre><code class="language-solidity">event SessionStrategyRegistered(address indexed sessionStrategy, bool enabled);
</code></pre>
<h3 id="promptstrategyregistered"><a class="header" href="#promptstrategyregistered">PromptStrategyRegistered</a></h3>
<pre><code class="language-solidity">event PromptStrategyRegistered(address indexed promptStrategy, bool enabled);
</code></pre>
<h3 id="rewardstrategyregistered"><a class="header" href="#rewardstrategyregistered">RewardStrategyRegistered</a></h3>
<pre><code class="language-solidity">event RewardStrategyRegistered(address indexed rewardStrategy, bool enabled);
</code></pre>
<h3 id="paymenttokenregistered"><a class="header" href="#paymenttokenregistered">PaymentTokenRegistered</a></h3>
<pre><code class="language-solidity">event PaymentTokenRegistered(address indexed paymentToken, bool enabled);
</code></pre>
<h3 id="engageprotocolregistered"><a class="header" href="#engageprotocolregistered">EngageProtocolRegistered</a></h3>
<pre><code class="language-solidity">event EngageProtocolRegistered(address indexed engageProtocol, bool enabled);
</code></pre>
<h3 id="protocoltreasuryset"><a class="header" href="#protocoltreasuryset">ProtocolTreasurySet</a></h3>
<pre><code class="language-solidity">event ProtocolTreasurySet(address treasury);
</code></pre>
<h3 id="referrerupdated"><a class="header" href="#referrerupdated">ReferrerUpdated</a></h3>
<pre><code class="language-solidity">event ReferrerUpdated(address indexed player, address indexed referrer);
</code></pre>
<h2 id="errors-12"><a class="header" href="#errors-12">Errors</a></h2>
<h3 id="unsupportedcontract"><a class="header" href="#unsupportedcontract">UnsupportedContract</a></h3>
<pre><code class="language-solidity">error UnsupportedContract(address contractAddress);
</code></pre>
<h3 id="invalidaddress-1"><a class="header" href="#invalidaddress-1">InvalidAddress</a></h3>
<pre><code class="language-solidity">error InvalidAddress();
</code></pre>
<h3 id="cantreferself"><a class="header" href="#cantreferself">CantReferSelf</a></h3>
<pre><code class="language-solidity">error CantReferSelf(address player);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="constants"><a class="header" href="#constants">Constants</a></h1>
<p><a href="https://github.com/Engage-Protocol/engage-protocol/blob/62e4edb5917eb23b13556127a45784792d64552a/src/Roles.sol">Git Source</a></p>
<h3 id="protocol_admin_role"><a class="header" href="#protocol_admin_role">PROTOCOL_ADMIN_ROLE</a></h3>
<p><em>Role for setting global variables, mostly related to session rules.</em></p>
<pre><code class="language-solidity">bytes32 constant PROTOCOL_ADMIN_ROLE = keccak256("PROTOCOL_ADMIN_ROLE");
</code></pre>
<h3 id="admin_role"><a class="header" href="#admin_role">ADMIN_ROLE</a></h3>
<p><em>Role for account-related actions: verification, referrers</em></p>
<pre><code class="language-solidity">bytes32 constant ADMIN_ROLE = keccak256("ADMIN_ROLE");
</code></pre>
<h3 id="upgrader_role"><a class="header" href="#upgrader_role">UPGRADER_ROLE</a></h3>
<p><em>Role for turning on/off protocol version by disabling session creation. Same address as the owner of the Registry, so it can disable/enable modules</em></p>
<pre><code class="language-solidity">bytes32 constant UPGRADER_ROLE = keccak256("UPGRADER_ROLE");
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sessionmanager-4"><a class="header" href="#sessionmanager-4">SessionManager</a></h1>
<p><a href="https://github.com/Engage-Protocol/engage-protocol/blob/62e4edb5917eb23b13556127a45784792d64552a/src/SessionManager.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/SessionManager.sol//src/QuestionManager.sol/abstract.QuestionManager.html">QuestionManager</a></p>
<p>Core contract managing the lifecycle of sessions</p>
<p><em>Handles session creation, state management, and participant interactions</em></p>
<p><em>Uses the QuestionManager for question handling and DepositManager for financial operations</em></p>
<p><em>Implements verification and liveness checks for participants</em></p>
<p><em>Manages session rescheduling and refund mechanisms</em></p>
<h2 id="state-variables-10"><a class="header" href="#state-variables-10">State Variables</a></h2>
<h3 id="minimumrescheduletime"><a class="header" href="#minimumrescheduletime">minimumRescheduleTime</a></h3>
<p>Minimum time required between original start time and rescheduled start time</p>
<pre><code class="language-solidity">uint256 public constant minimumRescheduleTime = 15 minutes;
</code></pre>
<h3 id="nextgameid"><a class="header" href="#nextgameid">nextGameId</a></h3>
<p>Next available game ID, incremented after each game creation, starting from 1</p>
<pre><code class="language-solidity">uint256 public nextGameId = 1;
</code></pre>
<h3 id="minimumstartdelay"><a class="header" href="#minimumstartdelay">minimumStartDelay</a></h3>
<p>Minimum delay required between game creation and start time</p>
<pre><code class="language-solidity">uint256 public minimumStartDelay = 1 days;
</code></pre>
<h3 id="maxgameduration"><a class="header" href="#maxgameduration">maxGameDuration</a></h3>
<p>Maximum allowed duration for a game in seconds</p>
<pre><code class="language-solidity">uint256 public maxGameDuration = 10 minutes;
</code></pre>
<h3 id="minimumcontestants"><a class="header" href="#minimumcontestants">minimumContestants</a></h3>
<p>Minimum number of contestants required to start a game</p>
<pre><code class="language-solidity">uint256 public minimumContestants = 3;
</code></pre>
<h3 id="maximumcontestants"><a class="header" href="#maximumcontestants">maximumContestants</a></h3>
<p>Maximum number of contestants allowed in a game</p>
<pre><code class="language-solidity">uint256 public maximumContestants = 1_000_000;
</code></pre>
<h3 id="revealgraceperiod"><a class="header" href="#revealgraceperiod">revealGracePeriod</a></h3>
<p>Grace period to start the game after the scheduled start time and reveal the first question</p>
<pre><code class="language-solidity">uint256 public revealGracePeriod = 10 minutes;
</code></pre>
<h3 id="livenessduration"><a class="header" href="#livenessduration">livenessDuration</a></h3>
<p>Duration for which a participant's liveness is considered valid</p>
<pre><code class="language-solidity">uint256 public livenessDuration = 1 hours;
</code></pre>
<h3 id="livenessrequired"><a class="header" href="#livenessrequired">livenessRequired</a></h3>
<p>Whether liveness check is required for participants to join games. This is only planned to be used if we see heavy botting</p>
<pre><code class="language-solidity">bool public livenessRequired = false;
</code></pre>
<h3 id="creationsunsetted"><a class="header" href="#creationsunsetted">creationSunsetted</a></h3>
<p>Whether session creation is disabled</p>
<pre><code class="language-solidity">bool public creationSunsetted = false;
</code></pre>
<h3 id="games"><a class="header" href="#games">games</a></h3>
<p>Mapping of game ID to game details</p>
<pre><code class="language-solidity">mapping(uint256 =&gt; Game) public games;
</code></pre>
<h3 id="contestants"><a class="header" href="#contestants">contestants</a></h3>
<p>Mapping of game ID and participant address to their participation status</p>
<pre><code class="language-solidity">mapping(uint256 gameId =&gt; mapping(address player =&gt; bool joined)) public contestants;
</code></pre>
<h3 id="isverificationapproved"><a class="header" href="#isverificationapproved">isVerificationApproved</a></h3>
<p>Mapping of participant addresses to their verification status</p>
<pre><code class="language-solidity">mapping(address =&gt; bool) public isVerificationApproved;
</code></pre>
<h3 id="liveness"><a class="header" href="#liveness">liveness</a></h3>
<p>Mapping of participant addresses to their last liveness check</p>
<pre><code class="language-solidity">mapping(address =&gt; uint256 timestamp) public liveness;
</code></pre>
<h2 id="functions-13"><a class="header" href="#functions-13">Functions</a></h2>
<h3 id="constructor-10"><a class="header" href="#constructor-10">constructor</a></h3>
<pre><code class="language-solidity">constructor(address _registry) QuestionManager(_registry);
</code></pre>
<h3 id="onlycreator"><a class="header" href="#onlycreator">onlyCreator</a></h3>
<p>Ensures that only the creator of a game can call the function</p>
<pre><code class="language-solidity">modifier onlyCreator(uint256 _gameId);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the game to check creator permissions for</td></tr>
</tbody></table>
</div>
<h3 id="onlystate"><a class="header" href="#onlystate">onlyState</a></h3>
<p>Ensures that the session is in the expected state</p>
<pre><code class="language-solidity">modifier onlyState(uint256 _gameId, SessionState _state);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the session to check state for</td></tr>
<tr><td><code>_state</code></td><td><code>SessionState</code></td><td>The expected state of the session</td></tr>
</tbody></table>
</div>
<h3 id="creategame"><a class="header" href="#creategame">createGame</a></h3>
<p>Creates a new session with the specified parameters</p>
<pre><code class="language-solidity">function createGame(
    uint256 _startTime,
    uint256 _endTime,
    uint256 _ticketPrice,
    uint256 _creatorFee,
    address _token,
    bytes32[] memory _promptHashes,
    address[] memory _promptStrategies,
    address _sessionStrategy,
    address _rewardStrategy,
    bool _verificationRequired
) external returns (uint256 gameId);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_startTime</code></td><td><code>uint256</code></td><td>Timestamp when the session should start</td></tr>
<tr><td><code>_endTime</code></td><td><code>uint256</code></td><td>Timestamp when the session should end</td></tr>
<tr><td><code>_ticketPrice</code></td><td><code>uint256</code></td><td>Price for each contestant to join the session</td></tr>
<tr><td><code>_creatorFee</code></td><td><code>uint256</code></td><td>Percentage of fees that go to the creator</td></tr>
<tr><td><code>_token</code></td><td><code>address</code></td><td>Address of the token used for payments</td></tr>
<tr><td><code>_promptHashes</code></td><td><code>bytes32[]</code></td><td>Array of hashed prompts for the session</td></tr>
<tr><td><code>_promptStrategies</code></td><td><code>address[]</code></td><td>Array of prompt strategy contracts for each prompt</td></tr>
<tr><td><code>_sessionStrategy</code></td><td><code>address</code></td><td>Address of the session strategy to use</td></tr>
<tr><td><code>_rewardStrategy</code></td><td><code>address</code></td><td>Address of the reward strategy to use</td></tr>
<tr><td><code>_verificationRequired</code></td><td><code>bool</code></td><td>Whether participants need to be verified before joining</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>The ID of the newly created session</td></tr>
</tbody></table>
</div>
<h3 id="joingame"><a class="header" href="#joingame">joinGame</a></h3>
<p>Allows a participant to join a session</p>
<p><em>Requires payment of the session's ticket price</em></p>
<p><em>Requires verification if the session has verification enabled</em></p>
<p><em>Requires liveness check if liveness is required</em></p>
<pre><code class="language-solidity">function joinGame(uint256 _gameId) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the session to join</td></tr>
</tbody></table>
</div>
<h3 id="leaverescheduledgame"><a class="header" href="#leaverescheduledgame">leaveRescheduledGame</a></h3>
<p>Allows a participant to leave a rescheduled session and get a refund</p>
<p><em>Only works for sessions in Created state</em></p>
<p><em>Only works for rescheduled sessions</em></p>
<p><em>Must be called before the minimum reschedule time has passed</em></p>
<pre><code class="language-solidity">function leaveRescheduledGame(uint256 _gameId) external onlyState(_gameId, SessionState.Created);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the rescheduled session to leave</td></tr>
</tbody></table>
</div>
<h3 id="commitreaction-4"><a class="header" href="#commitreaction-4">commitReaction</a></h3>
<p>Commits a participant's reaction to a question in an ongoing session</p>
<p><em>Only works for sessions in Ongoing state</em></p>
<p><em>Participant must be a contestant in the session</em></p>
<pre><code class="language-solidity">function commitReaction(uint256 _gameId, uint256 _questionId, bytes32 _commit)
    external
    onlyState(_gameId, SessionState.Ongoing);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the session</td></tr>
<tr><td><code>_questionId</code></td><td><code>uint256</code></td><td>The ID of the question to react to</td></tr>
<tr><td><code>_commit</code></td><td><code>bytes32</code></td><td>The hashed commitment of the participant's reaction</td></tr>
</tbody></table>
</div>
<h3 id="revealreactions"><a class="header" href="#revealreactions">revealReactions</a></h3>
<p>Reveals a participant's reactions to multiple questions in a session</p>
<pre><code class="language-solidity">function revealReactions(uint256 _gameId, uint256[] calldata questionIds, bytes[] calldata answers, uint256 salt)
    external
    onlyState(_gameId, SessionState.Ongoing);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the session</td></tr>
<tr><td><code>questionIds</code></td><td><code>uint256[]</code></td><td>Array of question IDs to reveal answers for</td></tr>
<tr><td><code>answers</code></td><td><code>bytes[]</code></td><td>Array of answers corresponding to each question</td></tr>
<tr><td><code>salt</code></td><td><code>uint256</code></td><td>The salt used in the commitment</td></tr>
</tbody></table>
</div>
<h3 id="refundcancelledgame"><a class="header" href="#refundcancelledgame">refundCancelledGame</a></h3>
<p>Refunds the entry fee to a participant for a cancelled session</p>
<pre><code class="language-solidity">function refundCancelledGame(uint256 _gameId) external onlyState(_gameId, SessionState.Cancelled);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the cancelled session</td></tr>
</tbody></table>
</div>
<h3 id="refundsponsorfunds-1"><a class="header" href="#refundsponsorfunds-1">refundSponsorFunds</a></h3>
<p>Refunds sponsor funds for a cancelled session</p>
<pre><code class="language-solidity">function refundSponsorFunds(uint256 _gameId) external onlyState(_gameId, SessionState.Cancelled);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the cancelled session</td></tr>
</tbody></table>
</div>
<h3 id="startandrevealgamequestion"><a class="header" href="#startandrevealgamequestion">startAndRevealGameQuestion</a></h3>
<p>Starts a session and reveals the first question</p>
<pre><code class="language-solidity">function startAndRevealGameQuestion(uint256 _gameId, uint256 _questionId, bytes memory _question, uint256 _salt)
    external
    onlyState(_gameId, SessionState.Created);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the session</td></tr>
<tr><td><code>_questionId</code></td><td><code>uint256</code></td><td>The ID of the question to reveal</td></tr>
<tr><td><code>_question</code></td><td><code>bytes</code></td><td>The question data</td></tr>
<tr><td><code>_salt</code></td><td><code>uint256</code></td><td>The salt used for the question commitment</td></tr>
</tbody></table>
</div>
<h3 id="revealgamequestion"><a class="header" href="#revealgamequestion">revealGameQuestion</a></h3>
<p>Reveals a question in an ongoing session</p>
<pre><code class="language-solidity">function revealGameQuestion(uint256 _gameId, uint256 _questionId, bytes memory _question, uint256 _salt)
    external
    onlyState(_gameId, SessionState.Ongoing);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the session</td></tr>
<tr><td><code>_questionId</code></td><td><code>uint256</code></td><td>The ID of the question to reveal</td></tr>
<tr><td><code>_question</code></td><td><code>bytes</code></td><td>The question data</td></tr>
<tr><td><code>_salt</code></td><td><code>uint256</code></td><td>The salt used for the question commitment</td></tr>
</tbody></table>
</div>
<h3 id="endgame"><a class="header" href="#endgame">endGame</a></h3>
<p>Ends an ongoing session</p>
<pre><code class="language-solidity">function endGame(uint256 _gameId) external onlyState(_gameId, SessionState.Ongoing);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the session to end</td></tr>
</tbody></table>
</div>
<h3 id="cancelgame"><a class="header" href="#cancelgame">cancelGame</a></h3>
<p>Cancels a session</p>
<pre><code class="language-solidity">function cancelGame(uint256 _gameId) external onlyCreator(_gameId);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the session to cancel</td></tr>
</tbody></table>
</div>
<h3 id="cancelgameifcreatormissing"><a class="header" href="#cancelgameifcreatormissing">cancelGameIfCreatorMissing</a></h3>
<pre><code class="language-solidity">function cancelGameIfCreatorMissing(uint256 _gameId) external;
</code></pre>
<h3 id="reschedulegame"><a class="header" href="#reschedulegame">rescheduleGame</a></h3>
<p>Reschedules a session to a new start time</p>
<pre><code class="language-solidity">function rescheduleGame(uint256 _gameId, uint256 _newStartTime)
    external
    onlyCreator(_gameId)
    onlyState(_gameId, SessionState.Created);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the session to reschedule</td></tr>
<tr><td><code>_newStartTime</code></td><td><code>uint256</code></td><td>The new start time for the session</td></tr>
</tbody></table>
</div>
<h3 id="concludegame"><a class="header" href="#concludegame">concludeGame</a></h3>
<p>Concludes a session and makes sure winners are determined, so rewards can be distributed</p>
<pre><code class="language-solidity">function concludeGame(uint256 _gameId) external onlyCreator(_gameId) onlyState(_gameId, SessionState.Ended);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the session to conclude</td></tr>
</tbody></table>
</div>
<h3 id="claimrewards"><a class="header" href="#claimrewards">claimRewards</a></h3>
<p>Distributes rewards to winners of a concluded session</p>
<pre><code class="language-solidity">function claimRewards(uint256 _gameId, uint256 position) external onlyState(_gameId, SessionState.Concluded);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the session</td></tr>
<tr><td><code>position</code></td><td><code>uint256</code></td><td></td></tr>
</tbody></table>
</div>
<h3 id="distributefees"><a class="header" href="#distributefees">distributeFees</a></h3>
<p>Distributes protocol and creator fees for a concluded session</p>
<pre><code class="language-solidity">function distributeFees(uint256 _gameId) external onlyState(_gameId, SessionState.Concluded);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the session</td></tr>
</tbody></table>
</div>
<h3 id="claimreferralrewards"><a class="header" href="#claimreferralrewards">claimReferralRewards</a></h3>
<p>Claims referral rewards for the caller for multiple sessions</p>
<pre><code class="language-solidity">function claimReferralRewards(uint256[] memory _gameIds) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameIds</code></td><td><code>uint256[]</code></td><td>Array of session IDs to claim referral rewards for</td></tr>
</tbody></table>
</div>
<h3 id="getgamestarttime"><a class="header" href="#getgamestarttime">getGameStartTime</a></h3>
<p>Returns the scheduled start time of a session</p>
<pre><code class="language-solidity">function getGameStartTime(uint256 gameId) external view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>The ID of the session</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The start time as a Unix timestamp</td></tr>
</tbody></table>
</div>
<h3 id="getgameendtime"><a class="header" href="#getgameendtime">getGameEndTime</a></h3>
<p>Returns the scheduled end time of a session</p>
<pre><code class="language-solidity">function getGameEndTime(uint256 gameId) external view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>The ID of the session</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The end time as a Unix timestamp</td></tr>
</tbody></table>
</div>
<h3 id="getcontestantscount"><a class="header" href="#getcontestantscount">getContestantsCount</a></h3>
<p>Returns the number of contestants in a session</p>
<pre><code class="language-solidity">function getContestantsCount(uint256 _gameId) external view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the session</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The number of contestants</td></tr>
</tbody></table>
</div>
<h3 id="approveverification"><a class="header" href="#approveverification">approveVerification</a></h3>
<p>Sets the verification status of a participant for verification required sessions</p>
<pre><code class="language-solidity">function approveVerification(address _player, bool verified) external onlyRole(ADMIN_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_player</code></td><td><code>address</code></td><td>The address of the participant to approve</td></tr>
<tr><td><code>verified</code></td><td><code>bool</code></td><td>Whether the participant is verified</td></tr>
</tbody></table>
</div>
<h3 id="setminimumstartdelay"><a class="header" href="#setminimumstartdelay">setMinimumStartDelay</a></h3>
<p>Sets the minimum start delay for sessions</p>
<pre><code class="language-solidity">function setMinimumStartDelay(uint256 _minimumStartDelay) external onlyRole(PROTOCOL_ADMIN_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_minimumStartDelay</code></td><td><code>uint256</code></td><td>The new minimum start delay in seconds</td></tr>
</tbody></table>
</div>
<h3 id="setmaxgameduration"><a class="header" href="#setmaxgameduration">setMaxGameDuration</a></h3>
<p>Sets the maximum allowed session duration</p>
<pre><code class="language-solidity">function setMaxGameDuration(uint256 _maxGameDuration) external onlyRole(PROTOCOL_ADMIN_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_maxGameDuration</code></td><td><code>uint256</code></td><td>The new maximum session duration in seconds</td></tr>
</tbody></table>
</div>
<h3 id="setminimumcontestants"><a class="header" href="#setminimumcontestants">setMinimumContestants</a></h3>
<p>Sets the minimum number of contestants required to start a session</p>
<pre><code class="language-solidity">function setMinimumContestants(uint256 _minimumContestants) external onlyRole(PROTOCOL_ADMIN_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_minimumContestants</code></td><td><code>uint256</code></td><td>The new minimum number of contestants</td></tr>
</tbody></table>
</div>
<h3 id="setmaximumcontestants"><a class="header" href="#setmaximumcontestants">setMaximumContestants</a></h3>
<p>Sets the maximum number of contestants allowed in a session</p>
<pre><code class="language-solidity">function setMaximumContestants(uint256 _maximumContestants) external onlyRole(PROTOCOL_ADMIN_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_maximumContestants</code></td><td><code>uint256</code></td><td>The new maximum number of contestants</td></tr>
</tbody></table>
</div>
<h3 id="setrevealgraceperiod"><a class="header" href="#setrevealgraceperiod">setRevealGracePeriod</a></h3>
<p>Sets the grace period for revealing the first question after session start</p>
<pre><code class="language-solidity">function setRevealGracePeriod(uint256 _revealGracePeriod) external onlyRole(PROTOCOL_ADMIN_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_revealGracePeriod</code></td><td><code>uint256</code></td><td>The new reveal grace period in seconds</td></tr>
</tbody></table>
</div>
<h3 id="setlivenessrequired"><a class="header" href="#setlivenessrequired">setLivenessRequired</a></h3>
<p>Sets whether liveness is required for joining sessions</p>
<pre><code class="language-solidity">function setLivenessRequired(bool _livenessRequired) external onlyRole(PROTOCOL_ADMIN_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_livenessRequired</code></td><td><code>bool</code></td><td>Boolean indicating if liveness is required</td></tr>
</tbody></table>
</div>
<h3 id="setlivenessduration"><a class="header" href="#setlivenessduration">setLivenessDuration</a></h3>
<p>Sets the duration of the liveness period</p>
<pre><code class="language-solidity">function setLivenessDuration(uint256 _livenessDuration) external onlyRole(PROTOCOL_ADMIN_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_livenessDuration</code></td><td><code>uint256</code></td><td>The new liveness duration in seconds</td></tr>
</tbody></table>
</div>
<h3 id="setliveness"><a class="header" href="#setliveness">setLiveness</a></h3>
<p>Updates the liveness timestamp for a participant</p>
<pre><code class="language-solidity">function setLiveness(address participant) external onlyRole(PROTOCOL_ADMIN_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>participant</code></td><td><code>address</code></td><td>The address of the participant</td></tr>
</tbody></table>
</div>
<h3 id="setcreationsunsetted"><a class="header" href="#setcreationsunsetted">setCreationSunsetted</a></h3>
<p>Disables session creation, essentially sunsetting protocol version</p>
<pre><code class="language-solidity">function setCreationSunsetted() external onlyRole(UPGRADER_ROLE);
</code></pre>
<h3 id="getstarttime"><a class="header" href="#getstarttime">getStartTime</a></h3>
<p>Returns the start time of a session</p>
<pre><code class="language-solidity">function getStartTime(uint256 _gameId) external view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the session</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The start time as a Unix timestamp</td></tr>
</tbody></table>
</div>
<h3 id="getendtime"><a class="header" href="#getendtime">getEndTime</a></h3>
<p>Returns the end time of a session</p>
<pre><code class="language-solidity">function getEndTime(uint256 _gameId) external view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the session</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The end time as a Unix timestamp</td></tr>
</tbody></table>
</div>
<h3 id="getnumcontestants"><a class="header" href="#getnumcontestants">getNumContestants</a></h3>
<p>Returns the number of contestants in a session</p>
<pre><code class="language-solidity">function getNumContestants(uint256 _gameId) external view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the session</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The number of contestants</td></tr>
</tbody></table>
</div>
<h3 id="getsessionstrategy"><a class="header" href="#getsessionstrategy">getSessionStrategy</a></h3>
<p>Returns the session strategy address for a session</p>
<pre><code class="language-solidity">function getSessionStrategy(uint256 _gameId) external view returns (address);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the session</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>The address of the session strategy contract</td></tr>
</tbody></table>
</div>
<h3 id="getoriginalstarttime"><a class="header" href="#getoriginalstarttime">getOriginalStartTime</a></h3>
<p>Returns the original start time of a session (before rescheduling)</p>
<pre><code class="language-solidity">function getOriginalStartTime(uint256 _gameId) external view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the session</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The original start time as a Unix timestamp</td></tr>
</tbody></table>
</div>
<h3 id="getsessionstate"><a class="header" href="#getsessionstate">getSessionState</a></h3>
<p>Returns the current state of a session</p>
<pre><code class="language-solidity">function getSessionState(uint256 _gameId) external view returns (SessionState);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the session</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>SessionState</code></td><td>The current SessionState</td></tr>
</tbody></table>
</div>
<h3 id="getcreator"><a class="header" href="#getcreator">getCreator</a></h3>
<p>Returns the creator address of a session</p>
<pre><code class="language-solidity">function getCreator(uint256 _gameId) external view returns (address);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_gameId</code></td><td><code>uint256</code></td><td>The ID of the session</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>The address of the session creator</td></tr>
</tbody></table>
</div>
<h2 id="events-11"><a class="header" href="#events-11">Events</a></h2>
<h3 id="gamecreated"><a class="header" href="#gamecreated">GameCreated</a></h3>
<pre><code class="language-solidity">event GameCreated(
    uint256 indexed gameId,
    uint256 startTime,
    uint256 endTime,
    address entryToken,
    uint256 entryFee,
    address creator,
    uint256 creatorFee,
    uint256 totalPrompts,
    address sessionStrategy,
    address rewardStrategy,
    bool verificationRequired
);
</code></pre>
<h3 id="gameconcluded"><a class="header" href="#gameconcluded">GameConcluded</a></h3>
<pre><code class="language-solidity">event GameConcluded(uint256 indexed gameId, bool resultsPublished, bool resultsFinalized);
</code></pre>
<h3 id="refundrequested"><a class="header" href="#refundrequested">RefundRequested</a></h3>
<pre><code class="language-solidity">event RefundRequested(uint256 indexed gameId, address indexed contestant);
</code></pre>
<h3 id="contestantjoined"><a class="header" href="#contestantjoined">ContestantJoined</a></h3>
<pre><code class="language-solidity">event ContestantJoined(uint256 indexed gameId, address indexed contestant);
</code></pre>
<h3 id="gamestarted"><a class="header" href="#gamestarted">GameStarted</a></h3>
<pre><code class="language-solidity">event GameStarted(uint256 indexed gameId);
</code></pre>
<h3 id="gameended"><a class="header" href="#gameended">GameEnded</a></h3>
<pre><code class="language-solidity">event GameEnded(uint256 indexed gameId);
</code></pre>
<h3 id="gamecancelled"><a class="header" href="#gamecancelled">GameCancelled</a></h3>
<pre><code class="language-solidity">event GameCancelled(uint256 indexed gameId);
</code></pre>
<h3 id="gamerescheduled"><a class="header" href="#gamerescheduled">GameRescheduled</a></h3>
<pre><code class="language-solidity">event GameRescheduled(uint256 indexed gameId, uint256 newStartTime);
</code></pre>
<h3 id="rewardwithdrawn"><a class="header" href="#rewardwithdrawn">RewardWithdrawn</a></h3>
<pre><code class="language-solidity">event RewardWithdrawn(uint256 indexed gameId, address indexed claimer, uint256 amount);
</code></pre>
<h3 id="revealgraceperiodset"><a class="header" href="#revealgraceperiodset">RevealGracePeriodSet</a></h3>
<pre><code class="language-solidity">event RevealGracePeriodSet(uint256 gracePeriod);
</code></pre>
<h3 id="minimumstartdelayset"><a class="header" href="#minimumstartdelayset">MinimumStartDelaySet</a></h3>
<pre><code class="language-solidity">event MinimumStartDelaySet(uint256 delay);
</code></pre>
<h3 id="maxgamedurationset"><a class="header" href="#maxgamedurationset">MaxGameDurationSet</a></h3>
<pre><code class="language-solidity">event MaxGameDurationSet(uint256 duration);
</code></pre>
<h3 id="minimumcontestantsset"><a class="header" href="#minimumcontestantsset">MinimumContestantsSet</a></h3>
<pre><code class="language-solidity">event MinimumContestantsSet(uint256 contestants);
</code></pre>
<h3 id="maximumcontestantsset"><a class="header" href="#maximumcontestantsset">MaximumContestantsSet</a></h3>
<pre><code class="language-solidity">event MaximumContestantsSet(uint256 contestants);
</code></pre>
<h3 id="verificationapproved"><a class="header" href="#verificationapproved">VerificationApproved</a></h3>
<pre><code class="language-solidity">event VerificationApproved(address indexed player);
</code></pre>
<h3 id="livenessrequiredset"><a class="header" href="#livenessrequiredset">LivenessRequiredSet</a></h3>
<pre><code class="language-solidity">event LivenessRequiredSet(bool livenessRequired);
</code></pre>
<h3 id="livenessdurationset"><a class="header" href="#livenessdurationset">LivenessDurationSet</a></h3>
<pre><code class="language-solidity">event LivenessDurationSet(uint256 livenessDuration);
</code></pre>
<h3 id="livenessset"><a class="header" href="#livenessset">LivenessSet</a></h3>
<pre><code class="language-solidity">event LivenessSet(address indexed player);
</code></pre>
<h3 id="creationsunsettedset"><a class="header" href="#creationsunsettedset">CreationSunsettedSet</a></h3>
<pre><code class="language-solidity">event CreationSunsettedSet(bool creationSunsetted);
</code></pre>
<h2 id="errors-13"><a class="header" href="#errors-13">Errors</a></h2>
<h3 id="gameshouldstartinfuture"><a class="header" href="#gameshouldstartinfuture">GameShouldStartInFuture</a></h3>
<pre><code class="language-solidity">error GameShouldStartInFuture(uint256 minStartTime, uint256 startTime);
</code></pre>
<h3 id="gamedurationtoolong"><a class="header" href="#gamedurationtoolong">GameDurationTooLong</a></h3>
<pre><code class="language-solidity">error GameDurationTooLong(uint256 duration, uint256 maxDuration);
</code></pre>
<h3 id="notenoughcontestants"><a class="header" href="#notenoughcontestants">NotEnoughContestants</a></h3>
<pre><code class="language-solidity">error NotEnoughContestants(uint256 numContestants, uint256 minContestants);
</code></pre>
<h3 id="invalidgamestate-2"><a class="header" href="#invalidgamestate-2">InvalidGameState</a></h3>
<pre><code class="language-solidity">error InvalidGameState(SessionState expected, SessionState actual);
</code></pre>
<h3 id="toomanycontestants"><a class="header" href="#toomanycontestants">TooManyContestants</a></h3>
<pre><code class="language-solidity">error TooManyContestants(uint256 maxContestants, uint256 numContestants);
</code></pre>
<h3 id="gamehasnotstartedyet"><a class="header" href="#gamehasnotstartedyet">GameHasNotStartedYet</a></h3>
<pre><code class="language-solidity">error GameHasNotStartedYet(uint256 startTime, uint256 currentTime);
</code></pre>
<h3 id="gameisnotended"><a class="header" href="#gameisnotended">GameIsNotEnded</a></h3>
<pre><code class="language-solidity">error GameIsNotEnded(uint256 endTime, uint256 currentTime);
</code></pre>
<h3 id="nocontestantsingame"><a class="header" href="#nocontestantsingame">NoContestantsInGame</a></h3>
<pre><code class="language-solidity">error NoContestantsInGame(uint256 gameId);
</code></pre>
<h3 id="gamelogicnotregistered"><a class="header" href="#gamelogicnotregistered">GameLogicNotRegistered</a></h3>
<pre><code class="language-solidity">error GameLogicNotRegistered(address gameLogic);
</code></pre>
<h3 id="invalidcontestantsettings"><a class="header" href="#invalidcontestantsettings">InvalidContestantSettings</a></h3>
<pre><code class="language-solidity">error InvalidContestantSettings(uint256 minimumContestants, uint256 maximumContestants);
</code></pre>
<h3 id="gamelatetoreveal"><a class="header" href="#gamelatetoreveal">GameLateToReveal</a></h3>
<pre><code class="language-solidity">error GameLateToReveal(uint256 startTime, uint256 gracePeriod, uint256 currentTime);
</code></pre>
<h3 id="gameisnotrescheduled"><a class="header" href="#gameisnotrescheduled">GameIsNotRescheduled</a></h3>
<pre><code class="language-solidity">error GameIsNotRescheduled(uint256 gameId);
</code></pre>
<h3 id="gameisalreadyrescheduled"><a class="header" href="#gameisalreadyrescheduled">GameIsAlreadyRescheduled</a></h3>
<pre><code class="language-solidity">error GameIsAlreadyRescheduled(uint256 gameId);
</code></pre>
<h3 id="notjoined"><a class="header" href="#notjoined">NotJoined</a></h3>
<pre><code class="language-solidity">error NotJoined(address player, uint256 gameId);
</code></pre>
<h3 id="toolatetoleave"><a class="header" href="#toolatetoleave">TooLateToLeave</a></h3>
<pre><code class="language-solidity">error TooLateToLeave(uint256 gameId);
</code></pre>
<h3 id="rescheduletoosoon"><a class="header" href="#rescheduletoosoon">RescheduleTooSoon</a></h3>
<pre><code class="language-solidity">error RescheduleTooSoon(uint256 originalStartTime, uint256 minimumRescheduleTime, uint256 newStartTime);
</code></pre>
<h3 id="onlycreator-1"><a class="header" href="#onlycreator-1">OnlyCreator</a></h3>
<pre><code class="language-solidity">error OnlyCreator(uint256 gameId, address creator, address caller);
</code></pre>
<h3 id="notverified"><a class="header" href="#notverified">NotVerified</a></h3>
<pre><code class="language-solidity">error NotVerified(address player);
</code></pre>
<h3 id="arraylengthmismatch-1"><a class="header" href="#arraylengthmismatch-1">ArrayLengthMismatch</a></h3>
<pre><code class="language-solidity">error ArrayLengthMismatch();
</code></pre>
<h3 id="promptstrategynotregistered"><a class="header" href="#promptstrategynotregistered">PromptStrategyNotRegistered</a></h3>
<pre><code class="language-solidity">error PromptStrategyNotRegistered(address promptStrategy);
</code></pre>
<h3 id="nowinnersyet"><a class="header" href="#nowinnersyet">NoWinnersYet</a></h3>
<pre><code class="language-solidity">error NoWinnersYet(uint256 gameId);
</code></pre>
<h3 id="notlively"><a class="header" href="#notlively">NotLively</a></h3>
<pre><code class="language-solidity">error NotLively(address player);
</code></pre>
<h3 id="creationdisabled"><a class="header" href="#creationdisabled">CreationDisabled</a></h3>
<pre><code class="language-solidity">error CreationDisabled();
</code></pre>
<h3 id="questionnotrevealed-1"><a class="header" href="#questionnotrevealed-1">QuestionNotRevealed</a></h3>
<pre><code class="language-solidity">error QuestionNotRevealed(uint256 gameId, uint256 questionId);
</code></pre>
<h3 id="gamewaitingforconclusion"><a class="header" href="#gamewaitingforconclusion">GameWaitingForConclusion</a></h3>
<pre><code class="language-solidity">error GameWaitingForConclusion(uint256 gameId);
</code></pre>
<h3 id="paymenttokennotregistered"><a class="header" href="#paymenttokennotregistered">PaymentTokenNotRegistered</a></h3>
<pre><code class="language-solidity">error PaymentTokenNotRegistered(address paymentToken);
</code></pre>
<h3 id="notwinner"><a class="header" href="#notwinner">NotWinner</a></h3>
<pre><code class="language-solidity">error NotWinner(address winner, address player);
</code></pre>
<h3 id="sessionmanagermismatch"><a class="header" href="#sessionmanagermismatch">SessionManagerMismatch</a></h3>
<pre><code class="language-solidity">error SessionManagerMismatch(address sessionManager);
</code></pre>
<h2 id="structs-7"><a class="header" href="#structs-7">Structs</a></h2>
<h3 id="game"><a class="header" href="#game">Game</a></h3>
<p>Represents a game session with its configuration and state</p>
<pre><code class="language-solidity">struct Game {
    uint256 gameId;
    uint256 startTime;
    uint256 endTime;
    uint256 numContestants;
    address sessionStrategy;
    address rewardStrategy;
    uint256 originalStartTime;
    SessionState state;
    address creator;
    bool verificationRequired;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>gameId</code></td><td><code>uint256</code></td><td>Unique identifier for the game</td></tr>
<tr><td><code>startTime</code></td><td><code>uint256</code></td><td>Timestamp when the game is scheduled to start</td></tr>
<tr><td><code>endTime</code></td><td><code>uint256</code></td><td>Timestamp when the game is scheduled to end</td></tr>
<tr><td><code>numContestants</code></td><td><code>uint256</code></td><td>Current number of participants in the game</td></tr>
<tr><td><code>sessionStrategy</code></td><td><code>address</code></td><td>Address of the contract implementing the session evaluation logic</td></tr>
<tr><td><code>rewardStrategy</code></td><td><code>address</code></td><td>Address of the contract implementing the reward distribution logic</td></tr>
<tr><td><code>originalStartTime</code></td><td><code>uint256</code></td><td>Original start time before rescheduling (0 if not rescheduled)</td></tr>
<tr><td><code>state</code></td><td><code>SessionState</code></td><td>Current state of the game</td></tr>
<tr><td><code>creator</code></td><td><code>address</code></td><td>Address of the game creator</td></tr>
<tr><td><code>verificationRequired</code></td><td><code>bool</code></td><td>Whether participants need to be verified before joining</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="sessionstate"><a class="header" href="#sessionstate">SessionState</a></h1>
<p><a href="https://github.com/Engage-Protocol/engage-protocol/blob/62e4edb5917eb23b13556127a45784792d64552a/src/SessionManagerBase.sol">Git Source</a></p>
<p>Represents the possible states of a session throughout its lifecycle</p>
<pre><code class="language-solidity">enum SessionState {
    None,
    Created,
    Ongoing,
    Ended,
    Concluded,
    Cancelled
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sessionmanagerbase"><a class="header" href="#sessionmanagerbase">SessionManagerBase</a></h1>
<p><a href="https://github.com/Engage-Protocol/engage-protocol/blob/62e4edb5917eb23b13556127a45784792d64552a/src/SessionManagerBase.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
AccessControl</p>
<h2 id="state-variables-11"><a class="header" href="#state-variables-11">State Variables</a></h2>
<h3 id="registry-4"><a class="header" href="#registry-4">registry</a></h3>
<p>Address of the registry contract</p>
<pre><code class="language-solidity">address public immutable registry;
</code></pre>
<h2 id="functions-14"><a class="header" href="#functions-14">Functions</a></h2>
<h3 id="constructor-11"><a class="header" href="#constructor-11">constructor</a></h3>
<pre><code class="language-solidity">constructor(address _registry);
</code></pre>
<h2 id="errors-14"><a class="header" href="#errors-14">Errors</a></h2>
<h3 id="invalidaddress-2"><a class="header" href="#invalidaddress-2">InvalidAddress</a></h3>
<pre><code class="language-solidity">error InvalidAddress();
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="solidity.min.js"></script>

        <script>
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>

    </div>
    </body>
</html>
